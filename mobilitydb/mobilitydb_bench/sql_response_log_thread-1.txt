thread-1 started executing at 2025-01-31T21:24:32.081846500Z with 60 queries.
1: SELECT f.flightid, valueAtTimeStamp(f.altitude, timestamptz'2023-06-05 15:52:50'), ST_asText(valueAtTimeStamp(f.trip, timestamptz'2023-06-05 15:52:50')) AS location, timestamptz'2023-06-05 15:52:50' FROM citus.flights f WHERE attime(f.trip, timestamptz'2023-06-05 15:52:50') IS NOT NULL;

flightid	valueattimestamp	location	timestamptz	
722564851	2438.4	POINT(8.6680927 52.0026919)	2023-06-05 15:52:50+02	
722579881	1456	POINT(8.0585195 51.758007)	2023-06-05 15:52:50+02	
722569581	7314.5	POINT(7.2144014 51.9720375)	2023-06-05 15:52:50+02	
722568061	9107.9	POINT(6.5447441 50.9811819)	2023-06-05 15:52:50+02	
722561590	717.1	POINT(7.0087456 50.963252)	2023-06-05 15:52:50+02	
722567401	7261.1	POINT(7.6418281 51.6778023)	2023-06-05 15:52:50+02	
722568331	8367.8	POINT(7.2595773 52.1372901)	2023-06-05 15:52:50+02	
722563831	2720.1	POINT(7.4184184 50.9051421)	2023-06-05 15:52:50+02	
722566611	6223.5	POINT(7.3079193 51.9191361)	2023-06-05 15:52:50+02	
722565461	3358.9	POINT(7.2718303 51.4213008)	2023-06-05 15:52:50+02	
722568601	10363.5	POINT(7.1935073 51.6724642)	2023-06-05 15:52:50+02	
722568931	6096	POINT(7.6509841 52.0929789)	2023-06-05 15:52:50+02	
722572791	10371	POINT(7.5283711 51.4254242)	2023-06-05 15:52:50+02	
722566871	1970.1	POINT(6.434448 51.0528388)	2023-06-05 15:52:50+02	
722577131	3662.7	POINT(7.8722446 51.3289288)	2023-06-05 15:52:50+02	
722568651	9753.5	POINT(6.7529321 51.8270704)	2023-06-05 15:52:50+02	
722574791	9084.2	POINT(8.1532597 51.9459705)	2023-06-05 15:52:50+02	
722569851	11582.4	POINT(8.1563897 50.9527479)	2023-06-05 15:52:50+02	
722569311	10666.3	POINT(6.2759336 51.5257986)	2023-06-05 15:52:50+02	
722575791	11277.6	POINT(6.862107 51.0870356)	2023-06-05 15:52:50+02	
722568581	11582.4	POINT(6.8112967 50.487887)	2023-06-05 15:52:50+02	
722565490	853.9	POINT(6.9972526 51.0346929)	2023-06-05 15:52:50+02	
722577121	4281.5	POINT(7.3375203 51.1843807)	2023-06-05 15:52:50+02	
722576841	1780.8	POINT(6.9982578 51.3451946)	2023-06-05 15:52:50+02	
722558921	1160.4	POINT(7.5412671 51.9238112)	2023-06-05 15:52:50+02	
722564281	4268.5	POINT(7.0439359 51.3532628)	2023-06-05 15:52:50+02	
722573121	6384.1	POINT(7.6429055 51.0204376)	2023-06-05 15:52:50+02	
722565831	4333.5	POINT(7.5241327 51.4269379)	2023-06-05 15:52:50+02	
722576821	10270.2	POINT(6.5768524 51.6375434)	2023-06-05 15:52:50+02	
722574321	11276.7	POINT(7.5214899 50.9018679)	2023-06-05 15:52:50+02	
722575001	11047.4	POINT(7.6015576 51.1278356)	2023-06-05 15:52:50+02	
722569601	10972.9	POINT(7.9159725 52.2253012)	2023-06-05 15:52:50+02	
722573151	3317	POINT(6.7536335 51.3879859)	2023-06-05 15:52:50+02	
722562931	925.6	POINT(7.3383504 51.4518312)	2023-06-05 15:52:50+02	
722561870	809.5	POINT(6.5790578 51.2024796)	2023-06-05 15:52:50+02	
722562581	1105.1	POINT(6.519511 51.12607)	2023-06-05 15:52:50+02	
722565621	2133.6	POINT(7.5373953 51.5409511)	2023-06-05 15:52:50+02	
722575221	10667.2	POINT(7.1723809 50.9484449)	2023-06-05 15:52:50+02	
722576811	9993.6	POINT(7.3869037 51.9339756)	2023-06-05 15:52:50+02	
722567381	10972.8	POINT(6.8070146 51.7020866)	2023-06-05 15:52:50+02	
722567981	10965.3	POINT(6.9536946 51.1913461)	2023-06-05 15:52:50+02	

2: WITH hourly_flights AS ( SELECT generate_series( DATE '2023-05-04'::timestamp, DATE '2023-05-04' + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ), filtered_flights AS ( SELECT f.flightid, g.name AS municipality_name, g.geom as polygon,  attime(f.trip, span('2023-05-04'::timestamp, '2023-05-04'::timestamp + INTERVAL '1 day')) AS daily_trip FROM citus.flights f JOIN municipalities g ON eintersects(f.trip, g.geom) WHERE f.trip && span('2023-05-04'::timestamp, '2023-05-04'::timestamp + INTERVAL '1 day') AND g.name = 'Gem Marsberg' ) SELECT h.start_time, COUNT(f.flightid) AS active_flights FROM hourly_flights h LEFT JOIN filtered_flights f ON eintersects(attime(f.daily_trip, span(h.start_time, h.start_time + INTERVAL '1 hour')), polygon) WHERE f.municipality_name = 'Gem Marsberg' GROUP BY h.start_time ORDER BY h.start_time;

start_time	active_flights	
2023-05-04 00:00:00	2	
2023-05-04 01:00:00	3	
2023-05-04 02:00:00	1	
2023-05-04 03:00:00	2	
2023-05-04 04:00:00	2	
2023-05-04 05:00:00	7	
2023-05-04 06:00:00	7	
2023-05-04 07:00:00	8	
2023-05-04 08:00:00	11	
2023-05-04 09:00:00	6	
2023-05-04 10:00:00	6	
2023-05-04 11:00:00	7	
2023-05-04 12:00:00	6	
2023-05-04 13:00:00	5	
2023-05-04 14:00:00	4	
2023-05-04 15:00:00	6	
2023-05-04 16:00:00	8	
2023-05-04 17:00:00	5	
2023-05-04 18:00:00	5	
2023-05-04 19:00:00	5	
2023-05-04 20:00:00	6	
2023-05-04 21:00:00	7	
2023-05-04 22:00:00	3	

3: WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), airport_city_mapping AS ( SELECT a.icao, COALESCE(c.name, 'abroad') AS city_name FROM airports a LEFT JOIN cities c ON a.city = c.name ) SELECT f.flightid, f.origin AS origin_airport, acm1.city_name AS origin_city, f.destination AS destination_airport, acm2.city_name AS destination_city FROM citus.flights f JOIN counties k ON k.name = 'Krs Hamm' LEFT JOIN airport_city_mapping acm1 ON f.origin = acm1.icao LEFT JOIN airport_city_mapping acm2 ON f.destination = acm2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports)) AND f.trip && stbox(k.geom, tstzspan'[2023-05-13 01:45:21, 2023-05-14 12:54:31]') AND eintersects(attime(f.trip, tstzspan'[2023-05-13 01:45:21, 2023-05-14 12:54:31]'), k.geom) ORDER BY origin_airport, destination_airport, f.flightid;

flightid	origin_airport	origin_city	destination_airport	destination_city	
716201071	EDDF	abroad	EDDG	Muenster	
716288061	EDDF	abroad	EDDG	Muenster	
716475691	EDDF	abroad	EDDG	Muenster	
716228401	EDDG	Muenster	EDDF	abroad	
716452221	EDDG	Muenster	EDDF	abroad	
716174371	EDDG	Muenster	EDDM	abroad	
716209391	EDDG	Muenster	EDDM	abroad	
716394031	EDDG	Muenster	EDDM	abroad	
716451831	EDDG	Muenster	EDDM	abroad	
716533280	EDDG	Muenster	EDLW	Dortmund	
716533280	EDDG	Muenster	EDLW	Dortmund	
716393701	EDDG	Muenster	LOWW	abroad	
716379621	EDDG	Muenster	LSZC	abroad	
716169571	EDDG	Muenster	LTAI	abroad	
716477371	EDDK	Cologne	EDLV	abroad	
716529771	EDDK	Cologne	EDLW	Dortmund	
716381931	EDDL	Duesseldorf	LRSV	abroad	
716195151	EDDL	Duesseldorf	LTFJ	abroad	
716187511	EDDM	abroad	EDDG	Muenster	
716354251	EDDM	abroad	EDDG	Muenster	
716441031	EDDM	abroad	EDDG	Muenster	
716407281	EDDW	abroad	EDDK	Cologne	
716291851	EDKB	Bonn	EDHL	abroad	
716290310	EDLH	NULL	EDDG	Muenster	
716290311	EDLH	NULL	EDDG	Muenster	
716514181	EDLN	Moenchengladbach	EDLW	Dortmund	
716401451	EDLW	Dortmund	EPGD	abroad	
716210781	EDLW	Dortmund	EPSY	abroad	
716315711	EDLW	Dortmund	EYVI	abroad	
716358340	EDWQ	NULL	EDDG	Muenster	
716355900	EGSS	abroad	EDLW	Dortmund	
716355900	EGSS	abroad	EDLW	Dortmund	
716355901	EGSS	abroad	EDLW	Dortmund	
716199461	EKCH	abroad	EDDL	Duesseldorf	
716382431	ENAL	abroad	EDDK	Cologne	
716196001	EPGD	abroad	EDLW	Dortmund	
716186751	EPKT	abroad	EDLW	Dortmund	
716265131	EPKT	abroad	EDLW	Dortmund	
716502991	EPKT	abroad	EDLW	Dortmund	
716268411	EPSY	abroad	EDLW	Dortmund	
716192821	EPWA	abroad	EDDL	Duesseldorf	
716183641	EYVI	abroad	EDLW	Dortmund	
716386000	LEPA	abroad	EDLW	Dortmund	
716386001	LEPA	abroad	EDLW	Dortmund	
716366650	LIRN	abroad	EDLW	Dortmund	
716366651	LIRN	abroad	EDLW	Dortmund	
716169261	LTAI	abroad	EDDG	Muenster	
716440071	LTAI	abroad	EDDG	Muenster	
716444971	LTAI	abroad	EDDG	Muenster	
716446041	LTAI	abroad	EDDG	Muenster	
716190581	LTFM	NULL	EDDL	Duesseldorf	
716349490	LWOH	abroad	EDLW	Dortmund	
716349491	LWOH	abroad	EDLW	Dortmund	

4: WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), airport_city_mapping AS ( SELECT a.icao, COALESCE(c.name, 'abroad') AS city_name FROM airports a LEFT JOIN cities c ON a.city = c.name ) SELECT f.flightid, f.origin AS origin_airport, acm1.city_name AS origin_city, f.destination AS destination_airport, acm2.city_name AS destination_city FROM citus.flights f JOIN counties k ON k.name = 'Krs Duesseldorf' LEFT JOIN airport_city_mapping acm1 ON f.origin = acm1.icao LEFT JOIN airport_city_mapping acm2 ON f.destination = acm2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports)) AND f.trip && stbox(k.geom, tstzspan'[2023-06-08 13:09:05, 2023-06-08 19:28:17]') AND eintersects(attime(f.trip, tstzspan'[2023-06-08 13:09:05, 2023-06-08 19:28:17]'), k.geom) ORDER BY origin_airport, destination_airport, f.flightid;

flightid	origin_airport	origin_city	destination_airport	destination_city	
723300420	EDDB	abroad	EDDL	Duesseldorf	
723300421	EDDB	abroad	EDDL	Duesseldorf	
723336170	EDDB	abroad	EDDL	Duesseldorf	
723336171	EDDB	abroad	EDDL	Duesseldorf	
723376830	EDDB	abroad	EDDL	Duesseldorf	
723299410	EDDF	abroad	EDDL	Duesseldorf	
723299411	EDDF	abroad	EDDL	Duesseldorf	
723385510	EDDH	abroad	EDDL	Duesseldorf	
723305300	EDDL	Duesseldorf	BKPR	abroad	
723324080	EDDL	Duesseldorf	BKPR	abroad	
723332520	EDDL	Duesseldorf	EDDB	abroad	
723368030	EDDL	Duesseldorf	EDDB	abroad	
723340880	EDDL	Duesseldorf	EDDF	abroad	
723392540	EDDL	Duesseldorf	EDDF	abroad	
723342130	EDDL	Duesseldorf	EDDH	abroad	
723394060	EDDL	Duesseldorf	EDDH	abroad	
723318620	EDDL	Duesseldorf	EDDM	abroad	
723356290	EDDL	Duesseldorf	EDDM	abroad	
723396450	EDDL	Duesseldorf	EDDM	abroad	
723325420	EDDL	Duesseldorf	EDXW	abroad	
723402540	EDDL	Duesseldorf	EFHK	abroad	
723397950	EDDL	Duesseldorf	EGBB	abroad	
723401850	EDDL	Duesseldorf	EGLC	abroad	
723355460	EDDL	Duesseldorf	EGLL	abroad	
723322430	EDDL	Duesseldorf	EGPH	abroad	
723331760	EDDL	Duesseldorf	EHAM	abroad	
723386300	EDDL	Duesseldorf	EHAM	abroad	
723299010	EDDL	Duesseldorf	EIDW	abroad	
723400420	EDDL	Duesseldorf	EKCH	abroad	
723298970	EDDL	Duesseldorf	ENGM	abroad	
723379620	EDDL	Duesseldorf	ESSA	abroad	
723300090	EDDL	Duesseldorf	GCLP	abroad	
723303820	EDDL	Duesseldorf	GMAD	abroad	
723320040	EDDL	Duesseldorf	LCLK	abroad	
723332850	EDDL	Duesseldorf	LDSP	abroad	
723399510	EDDL	Duesseldorf	LDSP	abroad	
723380600	EDDL	Duesseldorf	LEBL	abroad	
723297890	EDDL	Duesseldorf	LEJR	abroad	
723354490	EDDL	Duesseldorf	LEMG	abroad	
723371460	EDDL	Duesseldorf	LEMG	abroad	
723356050	EDDL	Duesseldorf	LEPA	abroad	
723362550	EDDL	Duesseldorf	LEPA	abroad	
723365560	EDDL	Duesseldorf	LEPA	abroad	
723375320	EDDL	Duesseldorf	LEPA	abroad	
723338470	EDDL	Duesseldorf	LFPG	abroad	
723370520	EDDL	Duesseldorf	LFPG	abroad	
723304460	EDDL	Duesseldorf	LGIR	abroad	
723357610	EDDL	Duesseldorf	LGIR	abroad	
723363700	EDDL	Duesseldorf	LGIR	abroad	
723306820	EDDL	Duesseldorf	LGKO	abroad	
723367270	EDDL	Duesseldorf	LGKV	abroad	
723306130	EDDL	Duesseldorf	LGTS	abroad	
723355720	EDDL	Duesseldorf	LGZA	abroad	
723395260	EDDL	Duesseldorf	LHBP	abroad	
723399680	EDDL	Duesseldorf	LIMC	abroad	
723386980	EDDL	Duesseldorf	LIML	abroad	
723392660	EDDL	Duesseldorf	LIPX	abroad	
723300410	EDDL	Duesseldorf	LIRF	abroad	
723371410	EDDL	Duesseldorf	LIRF	abroad	
723402370	EDDL	Duesseldorf	LKPR	abroad	
723344840	EDDL	Duesseldorf	LLBG	abroad	
723306080	EDDL	Duesseldorf	LOWW	abroad	
723348990	EDDL	Duesseldorf	LOWW	abroad	
723377650	EDDL	Duesseldorf	LOWW	abroad	
723346950	EDDL	Duesseldorf	LPFR	abroad	
723315360	EDDL	Duesseldorf	LPMA	abroad	
723361100	EDDL	Duesseldorf	LPPR	abroad	
723323650	EDDL	Duesseldorf	LPPT	abroad	
723393180	EDDL	Duesseldorf	LPPT	abroad	
723325980	EDDL	Duesseldorf	LSZH	abroad	
723340510	EDDL	Duesseldorf	LSZH	abroad	
723404340	EDDL	Duesseldorf	LSZH	abroad	
723343850	EDDL	Duesseldorf	LSZR	abroad	
723329000	EDDL	Duesseldorf	LTAI	abroad	
723336440	EDDL	Duesseldorf	LTAI	abroad	
723355390	EDDL	Duesseldorf	LTAI	abroad	
723394620	EDDL	Duesseldorf	LTAI	abroad	
723349640	EDDL	Duesseldorf	LTBJ	abroad	
723402800	EDDL	Duesseldorf	LTBJ	abroad	
723320020	EDDL	Duesseldorf	LTFJ	abroad	
723323290	EDDL	Duesseldorf	LTFJ	abroad	
723385900	EDDL	Duesseldorf	LTFJ	abroad	
723393140	EDDL	Duesseldorf	LTFJ	abroad	
723348060	EDDL	Duesseldorf	LTFM	NULL	
723404940	EDDL	Duesseldorf	LTFM	NULL	
723357310	EDDL	Duesseldorf	OMDB	abroad	
723353430	EDDL	Duesseldorf	OTHH	NULL	
723382480	EDDL	Duesseldorf	UDYZ	abroad	
723290740	EDDL	Duesseldorf	UGTB	abroad	
723297240	EDDM	abroad	EDDL	Duesseldorf	
723297241	EDDM	abroad	EDDL	Duesseldorf	
723312440	EDDM	abroad	EDDL	Duesseldorf	
723312441	EDDM	abroad	EDDL	Duesseldorf	
723361870	EDDM	abroad	EDDL	Duesseldorf	
723361871	EDDM	abroad	EDDL	Duesseldorf	
723380870	EDDM	abroad	EDDL	Duesseldorf	
723380871	EDDM	abroad	EDDL	Duesseldorf	
723338370	EDFH	abroad	EDDL	Duesseldorf	
723332401	EDKA	Aachen	EDLW	Dortmund	
723358041	EDLW	Dortmund	LEAL	abroad	
723359390	EDXW	abroad	EDDL	Duesseldorf	
723375760	EFHK	abroad	EDDL	Duesseldorf	
723368070	EGLC	abroad	EDDL	Duesseldorf	
723359491	EGLL	abroad	EDDK	Cologne	
723320050	EGLL	abroad	EDDL	Duesseldorf	
723387300	EGPH	abroad	EDDL	Duesseldorf	
723344551	EGSS	abroad	EDDK	Cologne	
723303890	EHAM	abroad	EDDL	Duesseldorf	
723367500	EHAM	abroad	EDDL	Duesseldorf	
723369940	EIDW	abroad	EDDL	Duesseldorf	
723388430	EKCH	abroad	EDDL	Duesseldorf	
723366060	ENGM	abroad	EDDL	Duesseldorf	
723372990	ENGM	abroad	EDDL	Duesseldorf	
723387970	ENGM	abroad	EDDL	Duesseldorf	
723327190	EPWR	abroad	EDDL	Duesseldorf	
723327191	EPWR	abroad	EDDL	Duesseldorf	
723343860	GCFV	abroad	EDDL	Duesseldorf	
723391630	HESH	abroad	EDDL	Duesseldorf	
723391631	HESH	abroad	EDDL	Duesseldorf	
723372440	LDSP	abroad	EDDL	Duesseldorf	
723372441	LDSP	abroad	EDDL	Duesseldorf	
723394850	LDSP	abroad	EDDL	Duesseldorf	
723394851	LDSP	abroad	EDDL	Duesseldorf	
723350460	LEBB	abroad	EDDL	Duesseldorf	
723343580	LEBL	abroad	EDDL	Duesseldorf	
723340860	LEIB	abroad	EDDL	Duesseldorf	
723382770	LEMD	abroad	EDDL	Duesseldorf	
723325201	LEMG	abroad	EDLW	Dortmund	
723376051	LEPA	abroad	EDDG	Muenster	
723290180	LEPA	abroad	EDDL	Duesseldorf	
723290181	LEPA	abroad	EDDL	Duesseldorf	
723306490	LEPA	abroad	EDDL	Duesseldorf	
723308670	LEPA	abroad	EDDL	Duesseldorf	
723342980	LEPA	abroad	EDDL	Duesseldorf	
723362540	LEPA	abroad	EDDL	Duesseldorf	
723379160	LEPA	abroad	EDDL	Duesseldorf	
723323641	LEPA	abroad	EDLW	Dortmund	
723363180	LEVC	abroad	EDDL	Duesseldorf	
723361360	LFMN	abroad	EDDL	Duesseldorf	
723333650	LFMP	abroad	EDDL	Duesseldorf	
723304060	LFPG	abroad	EDDL	Duesseldorf	
723341810	LFPG	abroad	EDDL	Duesseldorf	
723282110	LGAV	abroad	EDDL	Duesseldorf	
723331270	LGKO	abroad	EDDL	Duesseldorf	
723331271	LGKO	abroad	EDDL	Duesseldorf	
723304820	LGRP	abroad	EDDL	Duesseldorf	
723304821	LGRP	abroad	EDDL	Duesseldorf	
723317510	LGRP	abroad	EDDL	Duesseldorf	
723317511	LGRP	abroad	EDDL	Duesseldorf	
723288850	LICC	abroad	EDDL	Duesseldorf	
723288851	LICC	abroad	EDDL	Duesseldorf	
723305650	LIME	abroad	EDDL	Duesseldorf	
723305651	LIME	abroad	EDDL	Duesseldorf	
723354030	LIML	abroad	EDDL	Duesseldorf	
723354031	LIML	abroad	EDDL	Duesseldorf	
723321590	LIPZ	abroad	EDDL	Duesseldorf	
723321591	LIPZ	abroad	EDDL	Duesseldorf	
723307140	LOWW	abroad	EDDL	Duesseldorf	
723307141	LOWW	abroad	EDDL	Duesseldorf	
723353130	LOWW	abroad	EDDL	Duesseldorf	
723353131	LOWW	abroad	EDDL	Duesseldorf	
723332090	LPMA	abroad	EDDL	Duesseldorf	
723386710	LPMA	abroad	EDDL	Duesseldorf	
723365050	LPPT	abroad	EDDL	Duesseldorf	
723348300	LROP	abroad	EDDL	Duesseldorf	
723348301	LROP	abroad	EDDL	Duesseldorf	
723298060	LSZH	abroad	EDDL	Duesseldorf	
723298061	LSZH	abroad	EDDL	Duesseldorf	
723360410	LSZH	abroad	EDDL	Duesseldorf	
723375310	LSZH	abroad	EDDL	Duesseldorf	
723394500	LSZH	abroad	EDDL	Duesseldorf	
723394501	LSZH	abroad	EDDL	Duesseldorf	
723384800	LTAC	abroad	EDDL	Duesseldorf	
723384801	LTAC	abroad	EDDL	Duesseldorf	
723283350	LTAI	abroad	EDDL	Duesseldorf	
723289620	LTAI	abroad	EDDL	Duesseldorf	
723289621	LTAI	abroad	EDDL	Duesseldorf	
723358510	LTAI	abroad	EDDL	Duesseldorf	
723358511	LTAI	abroad	EDDL	Duesseldorf	
723376260	LTAI	abroad	EDDL	Duesseldorf	
723376261	LTAI	abroad	EDDL	Duesseldorf	
723381530	LTAI	abroad	EDDL	Duesseldorf	
723381531	LTAI	abroad	EDDL	Duesseldorf	
723392180	LTAI	abroad	EDDL	Duesseldorf	
723392181	LTAI	abroad	EDDL	Duesseldorf	
723395890	LTAI	abroad	EDDL	Duesseldorf	
723395891	LTAI	abroad	EDDL	Duesseldorf	
723393760	LTAJ	abroad	EDDL	Duesseldorf	
723393761	LTAJ	abroad	EDDL	Duesseldorf	
723296520	LTBJ	abroad	EDDL	Duesseldorf	
723296521	LTBJ	abroad	EDDL	Duesseldorf	
723384140	LTBJ	abroad	EDDL	Duesseldorf	
723384141	LTBJ	abroad	EDDL	Duesseldorf	
723385880	LTBS	abroad	EDDL	Duesseldorf	
723385881	LTBS	abroad	EDDL	Duesseldorf	
723356930	LTFD	abroad	EDDL	Duesseldorf	
723356931	LTFD	abroad	EDDL	Duesseldorf	
723340140	LTFJ	abroad	EDDL	Duesseldorf	
723340141	LTFJ	abroad	EDDL	Duesseldorf	
723344800	LTFJ	abroad	EDDL	Duesseldorf	
723295860	LTFM	NULL	EDDL	Duesseldorf	
723295861	LTFM	NULL	EDDL	Duesseldorf	
723364180	LTFM	NULL	EDDL	Duesseldorf	
723364181	LTFM	NULL	EDDL	Duesseldorf	
723284370	OMDB	abroad	EDDL	Duesseldorf	
723284370	OMDB	abroad	EDDL	Duesseldorf	
723284371	OMDB	abroad	EDDL	Duesseldorf	
723393130	OMDB	abroad	EDDL	Duesseldorf	
723393131	OMDB	abroad	EDDL	Duesseldorf	
723293660	OTHH	NULL	EDDL	Duesseldorf	
723293661	OTHH	NULL	EDDL	Duesseldorf	
723366640	SKBO	abroad	EDDL	Duesseldorf	
723338410	UDYZ	abroad	EDDL	Duesseldorf	
723338411	UDYZ	abroad	EDDL	Duesseldorf	

5: SELECT p.flightid, p.altitude, p.airplanetype, p.timestamp FROM flightpoints p JOIN cities c ON ST_DWithin(p.geom, c.geom, 30)   WHERE p.altitude <= 1050 AND c.population >= 200000;

flightid	altitude	airplanetype	timestamp	
730978851	1005.3	A319	2023-07-07 14:09:51	
727596640	308.1	C172	2023-06-24 11:01:03	
728456690	517.7	M20P	2023-06-27 10:53:59	
701683590	513.1	DA40	2023-03-06 11:29:02	
757359530	700.7	P28A	2023-09-19 09:27:18	
715713131	920.4	C172	2023-05-10 17:24:31	
713484680	622.6	P28A	2023-05-02 16:59:37	
726670431	951	C172	2023-06-20 13:56:18	
723398031	916.4	B738	2023-06-08 17:28:06	
707789400	673.2	TBM8	2023-04-05 13:22:46	
764511711	938.6	A319	2023-11-07 10:23:35	

6: SELECT g.name, f.flightid, f.origin, f.destination, f.airplanetype, duration(whenTrue(attime(f.altitude, tstzspan'[2023-10-06 11:18:05, 2023-10-20 00:27:58]') #< 1500 & tintersects(tgeompoint(attime(f.trip, tstzspan'[2023-10-06 11:18:05, 2023-10-20 00:27:58]')), geometry(g.geom)))) AS totalTimeBelowAltitude FROM municipalities g JOIN citus.flights f ON f.trip && stbox(g.geom, tstzspan'[2023-10-06 11:18:05, 2023-10-20 00:27:58]') AND eintersects(attime(f.trip, tstzspan'[2023-10-06 11:18:05, 2023-10-20 00:27:58]'), g.geom) WHERE g.name = 'Gem Rheine' AND duration(whenTrue(attime(f.altitude, tstzspan'[2023-10-06 11:18:05, 2023-10-20 00:27:58]') #< 1500 & tintersects(tgeompoint(attime(f.trip, tstzspan'[2023-10-06 11:18:05, 2023-10-20 00:27:58]')), geometry(g.geom)))) IS NOT NULL;

name	flightid	origin	destination	airplanetype	totaltimebelowaltitude	
Gem Rheine	756443310	EDLE	EDDG	P28A	00:00:06	
Gem Rheine	759357060	EDLP	EDLE	PA44	00:02:56	
Gem Rheine	759077181	EDLE	EDDG	DA42	00:10:02	
Gem Rheine	760278131	EDWO	EBKT	M20P	00:01:10	
Gem Rheine	760076060	EDWO	EDDG	BE33	00:04:11	

7: SELECT f.flightId, f.track, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN citus.flights AS f ON eDwithin(attime(f.trip, tstzspan'[2023-07-24 00:00:00, 2023-07-25 00:00:00]'), c.geom, 1250) WHERE c.name = 'Vlotho' AND f.trip && tstzspan'[2023-07-24 00:00:00, 2023-07-25 00:00:00]';

flightid	track	airplanetype	origin	destination	
735329681	1	B789	EDDF	KDFW	
735388491	3	E295	EHAM	EPWA	
735443301	1	A320	EDDV	LEPA	
735323521	1	PC12	EDDC	EDDG	
735386621	1	E75L	EDDC	EHAM	
735424071	1	B738	EDDB	EHAM	
735416671	2	B77W	EGCC	OTHH	
735437291	1	A320	LEMD	EVRA	

8: SELECT COUNT(*), tstzspan'[2023-04-12 07:21:03, 2023-04-17 17:52:48]' FROM citus.flights f WHERE f.trip && tstzspan'[2023-04-12 07:21:03, 2023-04-17 17:52:48]';

count	tstzspan	
28850	[2023-04-12 07:21:03+02, 2023-04-17 17:52:48+02]	

9: SELECT p.flightid, p.altitude, p.airplanetype, p.timestamp FROM flightpoints p JOIN cities c ON ST_DWithin(p.geom, c.geom, 100)   WHERE p.altitude <= 750 AND c.population >= 200000;

flightid	altitude	airplanetype	timestamp	
701683590	513.1	DA40	2023-03-06 11:29:02	
706231990	404.1	P28A	2023-03-28 13:49:32	
723646080	613.2	P28A	2023-06-09 15:16:02	
706424060	548	PA44	2023-03-29 12:08:19	
747227530	477.9	P28A	2023-09-07 14:54:32	
767865530	463.1	DA42	2023-11-24 12:12:14	
706455870	579.8	C172	2023-03-29 14:52:12	
703156120	732.7	P28A	2023-03-15 16:55:39	
691893930	244.1	EC35	2023-01-02 20:42:01	
751105590	648.2	TBM9	2023-09-25 06:22:26	
707678020	462	PA44	2023-04-05 09:15:13	
721835610	475.6	PA44	2023-06-03 09:07:21	
718638030	487.8	BE33	2023-05-22 09:17:02	
729048600	497.9	C182	2023-06-29 15:05:53	
707789400	673.2	TBM8	2023-04-05 13:22:46	
735868510	748.9	LJ35	2023-07-26 14:09:45	
694892570	639.3	P28A	2023-01-03 16:56:41	
718904360	518.9	M20P	2023-05-23 14:50:54	
726855520	465.5	PA44	2023-06-21 11:08:18	
767872880	593.2	PA44	2023-11-24 11:35:12	
704135640	619.8	C172	2023-03-18 21:00:43	
728484870	329	C56X	2023-06-27 11:50:47	
726568150	699.6	P46T	2023-06-20 07:17:11	
707993600	620.3	C172	2023-04-06 11:38:32	
717581630	517.9	M20P	2023-05-18 14:21:27	
727596640	308.1	C172	2023-06-24 11:01:03	
740226270	578.6	DA62	2023-08-11 15:43:53	
767466890	492.2	DA40	2023-11-22 10:59:55	
714041940	343.5	LJ35	2023-05-03 11:39:28	
725826800	645.7	SR20	2023-06-17 12:22:44	
728456690	517.7	M20P	2023-06-27 10:53:59	
740792020	415.4	PA44	2023-08-13 17:08:39	
697563760	512	DA42	2023-02-10 16:24:06	
757359530	700.7	P28A	2023-09-19 09:27:18	
730129950	662.4	C172	2023-07-04 08:41:47	
704646600	428.3	GA7	2023-03-20 15:04:23	
692763130	648.6	PA44	2023-01-08 17:04:19	
715333920	530.4	DA40	2023-05-08 18:01:37	
718904360	382.3	M20P	2023-05-23 14:58:14	
763048000	697.3	PA44	2023-10-30 16:25:59	
756827360	526.1	C172	2023-10-07 14:50:11	
740710390	714.8	TBM9	2023-08-13 13:21:55	
768019420	484.6	BE33	2023-11-25 11:18:33	
705337270	645.1	C172	2023-03-22 13:36:11	
730579540	581.1	DR40	2023-07-06 10:47:34	
733899670	284.5	EVOT	2023-07-18 15:52:32	
753580460	452	P28A	2023-09-29 15:18:30	
709735390	71.6	B738	2023-04-14 18:59:18	
693595650	600.7	DA42	2023-01-15 09:28:42	
755044720	581.5	GLF5	2023-09-17 12:03:01	
727109300	685	PA44	2023-06-22 10:34:02	
723956030	584.2	BE33	2023-06-10 16:09:09	
739698530	460.7	PA27	2023-08-10 07:57:42	
722614970	424.5	SW4	2023-06-05 15:41:20	
696484440	185.7	PC12	2023-02-04 12:23:25	
698912840	409	BT36	2023-02-19 14:04:04	
693148460	735.5	C172	2023-01-11 15:40:02	
695086020	225.8	P46T	2023-01-24 16:17:27	
766943250	575.5	P28A	2023-11-19 15:38:55	
712821590	640.3	A321	2023-04-30 08:48:09	
704696290	554.5	C172	2023-03-20 18:00:54	
713484680	622.6	P28A	2023-05-02 16:59:37	
733528530	482.5	PA44	2023-07-17 10:14:12	
733883220	518.1	PA44	2023-07-18 15:38:19	
700034930	517.1	PA44	2023-02-26 14:18:04	
709028970	703	C172	2023-04-11 09:32:35	
705929730	134.5	A320	2023-03-26 14:06:11	
710086830	360.3	DA40	2023-04-16 18:17:24	
715986790	446.3	PA44	2023-05-12 08:56:14	
718425160	419.5	GA7	2023-05-21 13:11:21	
758493010	689	C172	2023-10-11 12:33:08	
764642130	509.7	P28A	2023-11-07 21:50:20	

10: SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.traj, ST_GeogFromText('SRID=4326;POINT(7.038107227408294 51.256311458722024)')) AS min_distance FROM citus.flights f WHERE ST_DWithin(f.traj, ST_GeogFromText('SRID=4326;POINT(7.038107227408294 51.256311458722024)'), 115)   ORDER BY min_distance ASC;

flightid	airplanetype	origin	destination	min_distance	
745506421	A320	LEIB	EDDL	3.01680421	
727880231	B738	EHAM	EDDM	9.06424314	
748780001	A332	KDTW	EDDF	12.18005075	
728304181	B789	RJAA	EDDF	16.99081473	
709757921	A321	LROP	EGGW	16.99569254	
768085561	E190	LFPG	EDDL	18.60941573	
761001021	A321	EGPH	EDDF	19.12034099	
695623031	E190	LFPG	EDDL	19.29077266	
758362921	A320	LEPA	EDDL	19.51196445	
750977321	H25B	EFMA	LFMN	19.63333825	
720215431	E190	EHAM	EDDF	20.69875283	
761386241	E190	EHAM	EDDF	21.84430745	
703010591	E190	LFPG	EDDL	23.52313095	
716865311	E190	EHAM	EDDF	23.67067711	
757295151	E190	LSZH	EDDL	24.539519	
738187861	A320	EDDH	LEPA	25.45563138	
722742121	GL7T	EHAM	LOWK	26.36147727	
700681301	A319	EHAM	EDDF	27.04313048	
692918741	E190	LFPG	EDDL	27.35632137	
712193141	A319	LIPE	EDDL	30.0868256	
748844660	PA44	EDLE	EDLN	30.55556851	
707304291	A20N	EDDH	LPFR	30.73903141	
762101161	E295	EHAM	LKPR	31.72784481	
760139531	A319	LOWS	EDDL	32.11886241	
708991291	S22T	EDDV	EDLN	32.73556005	
744959041	DH8D	ESSA	ELLX	33.01009773	
728946421	B38M	EGSS	LHBP	33.53093113	
693661381	E190	LFPG	EDDL	34.15819854	
750688891	B38M	GCTS	EDDL	34.71647096	
750402261	E195	LPPT	EDDL	35.05551796	
700855881	B738	EHAM	LOWI	35.38027486	
705528371	A320	LEVC	EDDL	35.42118492	
742178201	A20N	LEBL	EDDL	35.54273266	
711951511	A319	EHAM	EDDF	36.21851936	
708085131	E190	EHAM	EDDF	36.24626528	
711753031	B738	EHAM	LGIR	36.93227329	
712050231	E190	LFPG	EDDL	36.93669041	
771774251	A321	GCFV	EDDL	37.10974774	
745885161	E190	EHAM	EDDF	37.12662251	
769819841	E190	LFPG	EDDL	38.54114313	
743853531	B738	EDLW	LEMG	38.76458924	
760736181	B38M	ESGG	LEAL	40.10667186	
766189351	A321	GCTS	EDDL	40.14024182	
710523421	A320	LEPA	EDDG	40.60437548	
710588191	E190	EHAM	EDDS	40.63016646	
709979791	A21N	EGGW	LHBP	40.6666116	
701424141	CRJ9	EHAM	EDDF	41.10620448	
715070661	BCS3	EDDH	LFPG	41.58673992	
722987511	B744	CYVR	EDDF	41.6271147	
716881111	CRJ9	EHAM	EDDF	42.01995039	
734243311	B737	EHAM	LJLJ	42.53091564	
706324271	E190	EHAM	EDDS	43.00491291	
748144201	A320	LEBL	EDDL	43.05938753	
747350581	B738	EHAM	LGZA	44.38429782	
763108951	E190	LFPG	EDDL	44.50836354	
696477481	A359	KLAX	EDDM	44.63103101	
735872021	A320	EHEH	LBSF	46.17190544	
729541131	B738	EGBB	LCLK	46.72516321	
734793231	A359	KDEN	EDDM	46.83535667	
712209761	B738	LTAI	EGNT	46.87220308	
701747961	B738	EHRD	LOWS	47.31313372	
715307191	B763	EHAM	EDDF	47.35223868	
763566881	B39M	EHAM	HEGN	47.53850985	
768271041	A320	GCLP	EDDL	47.75416096	
711206301	C56X	EHAM	LGTS	47.75831797	
762017701	A320	LEBL	EDDL	47.90816459	
707835721	B763	EHAM	EDDF	47.93657025	
734223901	A320	EGGW	LRSV	48.40474876	
772647981	A20N	EGPH	EDDF	48.82056412	
722480441	E170	EDDV	LFPG	49.37189836	
734433481	A21N	EHAM	HECA	50.52458013	
730122551	A321	LTFJ	EGSS	51.32755946	
763102061	DH8D	ELLX	EKCH	51.39280603	
720600641	BCS3	LROP	EDDL	51.4332915	
767999761	E190	EHAM	EDDF	51.45857713	
727656581	B738	EHRD	LTAI	51.54875498	
752417951	A333	CYYC	EDDF	52.82265044	
713316301	B788	EGBB	VIDP	53.63310238	
759494041	E190	EHAM	EDDF	54.14514864	
735363961	C182	EHHV	EDFZ	54.81038067	
748478021	A20N	EHRD	LTAI	55.20219801	
704513091	P28A	EDLE	EDDR	55.58809994	
762700451	A320	LEBL	EDDL	55.79971294	
754824271	C25A	EDDL	EDLN	55.82010984	
771027271	B738	EDDN	EGSS	56.02051975	
739351621	E190	LFPG	EDDL	56.02419127	
728316611	B763	EHAM	EDDF	56.65219306	
746887501	B738	LTAI	EDDL	56.76950075	
759805851	B763	EHAM	EDDF	56.82347006	
729105901	E190	LFPG	EDDL	57.00258754	
756361081	B77L	EBLG	ZHCC	57.15165467	
764296891	B739	EHAM	LIRF	57.37004559	
692288671	A320	GCFV	EDDL	57.50002235	
721650851	A320	EHAM	EDDF	57.79031665	
700646451	A320	EBBR	EDDB	58.38616623	
704402381	A320	LEPA	EDDL	58.65168411	
766990271	E190	EHAM	LDZA	58.99681852	
751357361	B788	EGBB	VIDP	59.09842846	
707315421	B763	EHAM	EDDF	59.62595987	
719956601	A20N	LGRP	EDDL	59.83178791	
715719721	DH8D	ELLX	EKCH	60.51895779	
702731681	A320	LEPA	EDDL	60.80375943	
729497941	B38M	EHAM	LGIR	61.49530607	
734500671	B38M	LZKZ	EGSS	61.76599758	
733212211	B38M	GCTS	EDDG	61.82313331	
742219641	A319	EHAM	LDZA	62.05809957	
761942461	B78X	LGAV	KEWR	62.31724694	
734249951	A20N	LOWW	EGLL	62.3666599	
724881371	B788	EGCC	LTAI	62.83214923	
727498131	BCS3	LSZH	EDDL	63.02717967	
743276531	A20N	EGPF	EDDF	63.19682415	
741674321	B752	BIKF	EDDF	63.37428211	
733254181	CL35	EHAM	EDDK	63.56566157	
717095071	A332	LEPA	EDDL	63.58012724	
753720441	A319	LEPA	EDDL	64.16211797	
731730741	E75L	EHAM	EDDM	64.5401651	
747625491	B78X	KORD	EDDF	65.3445539	
768263571	A321	LZIB	EGGW	65.3598248	
722433441	A320	EDDB	EBBR	65.50693053	
730877041	A319	LEIB	EDDL	65.56332827	
737937121	B772	KSFO	EDDM	66.1357321	
726589181	B748	KLAX	EDDF	66.34340714	
763150141	A320	EHAM	EDDM	66.56393525	
706551141	A20N	EGPF	EDDF	66.660278	
701735221	A319	LFMN	EDDL	66.74727544	
766430611	B788	EHAM	HKJK	67.18478919	
723266981	A319	LIEO	EDDL	67.82402427	
709305621	A320	LEMD	EDDL	67.89579422	
714935101	A320	LDPL	EDDL	68.33932219	
709446191	E75L	EHAM	EDDF	68.3716727	
735216081	B738	EHAM	LTAI	68.78119028	
758282721	B738	LTAI	EGSS	68.98482207	
743950801	B738	LZKZ	EGSS	69.08789981	
712612191	CRJ9	EDDM	EDDL	69.70160312	
751633841	A320	LOWW	EDDL	69.80101146	
739730891	B753	LEPA	EDDL	69.82301137	
696752301	C25C	EHAM	EDSB	69.99186724	
746261481	A359	KDEN	EDDM	70.0055935	
698287991	A320	LEPA	EDDL	70.11361859	
702783921	A320	EGCC	LOWW	70.27788185	
702357191	A20N	LGAV	EGKK	70.60402309	
771186101	E75L	EHAM	EDDF	71.41634136	
747597391	A319	EHAM	EDDF	72.17389832	
703448521	B78X	EGCC	OMAA	72.37343866	
738274841	B77L	EDDK	KIND	72.52728269	
697147611	A321	LEBL	EDDL	72.68810854	
734818171	E55P	LFRZ	EDDL	72.71320236	
769929511	E190	EHAM	EDDS	73.17886355	
744420371	DH8D	ENGM	ELLX	73.33539474	
768829591	E190	LFPG	EDDL	73.40732702	
711530791	A20N	EGPF	EDDF	73.65055352	
770503551	B788	EHAM	HKJK	73.66875635	
693544401	A320	GCLP	EDDL	73.73267414	
765450801	A321	GCRR	EDDL	73.84304693	
709830781	C680	EPWR	EDDL	74.3894906	
746210021	B77L	MMGL	EDDF	74.82326712	
758425151	E190	EHAM	EDDF	74.87963346	
709284391	A20N	LEBL	EDDL	74.98886826	
767794921	B738	EKCH	LFPG	75.00169756	
716299051	A320	LGAV	EDDL	75.46962428	
709393581	C25B	LPCS	EDDL	75.62378352	
723266991	A320	EHAM	EDDF	75.96456701	
774124191	B738	EHEH	LOWW	76.34887318	
740040911	B38M	LEPA	EDDL	76.415104	
768976811	B789	RJAA	EDDF	76.5177263	
723181431	B77W	KIAD	EDDF	77.15871615	
735317791	CRJ9	EHAM	EDDM	78.23958878	
764387421	A320	LEVC	EDDL	78.29259963	
753436671	B38M	LEPA	EDDL	78.52336875	
710674171	CRJ9	EHAM	EDDF	78.79072868	
715042281	A320	LOWW	EGSS	78.82235286	
738292611	A320	EGGW	LHDC	78.87598328	
763110781	A321	LEMG	EDDL	79.08797821	
747204791	A343	KLAX	EDDF	79.4115963	
772492431	A321	EHEH	LROP	79.42238647	
746794531	CRJX	LIML	EDDL	79.89090384	
747496791	B38M	BIKF	EDDF	80.05500841	
711432301	B763	KIAH	EDDM	80.24955525	
741909541	B39M	BIKF	EDDM	80.25067366	
751094651	E295	EHAM	EDDM	80.29414002	
741879371	E190	EHAM	EDDF	80.40296546	
712659581	B738	LKTB	EGSS	80.60364545	
702704441	B738	EHAM	LIRF	80.74907282	
706679051	B738	GCTS	EDDL	80.84308199	
731091961	B753	HEGN	EDDL	81.25342205	
738257611	A321	EHAM	EDDF	81.48573749	
717369611	B738	EHAM	LGSR	81.64793464	
761876971	A320	EDDG	LEPA	81.9088196	
767815731	A320	EHAM	EDDF	82.64453394	
732929491	B738	EGPF	LTBJ	82.65104143	
745267121	B738	EHAM	LGRP	83.16802105	
694482921	E190	EHAM	EDDF	83.29877012	
733201951	B788	EHAM	HKJK	83.42415849	
705980461	E75S	EPWA	EBBR	83.75184527	
718914471	B38M	EGSS	LHBP	83.7776631	
712020201	A21N	LOWW	EGKK	83.79168474	
709522061	E170	LFPG	EDDL	84.03832589	
714359961	B738	LIPZ	EGPH	84.53999141	
758879831	E190	LFPG	EDDL	84.63070238	
730013691	B738	ESSA	LEBL	84.78678801	
711489541	A20N	EHAM	LGIR	85.22944725	
741684201	E190	EHAM	EDDM	85.84743846	
736584911	E190	EHAM	EDDF	86.48218718	
692618511	E170	LFPG	EDDL	86.81895396	
721628431	A321	EDDH	LEPA	86.98251046	
773666481	A320	LEPA	EDDL	87.22635308	
756315431	C25C	EDDK	EDDL	87.86031163	
710331581	C56X	LZIB	EDDL	87.86924066	
716945671	A320	EHAM	EDDF	88.50085951	
760219161	E75L	EHAM	EDDS	89.38777388	
700162991	A319	EHAM	EDDF	89.53667083	
771636651	A320	EGPF	EDDF	90.55071087	
732452161	A320	LEBL	EDDL	90.6775525	
766014211	A320	EHAM	EDDF	90.88231097	
696143701	A21N	LROP	EGGW	91.13816186	
733152131	B738	GCLP	EDDL	91.14714244	
705277401	A333	LSZH	KJFK	91.15394817	
702408351	A320	EBBR	EDDB	91.20071482	
711949501	BE9T	EDAZ	EDLN	91.28283241	
724827191	E190	EHAM	EDDF	91.5777565	
747537791	BCS3	EDDH	LFPG	91.63113981	
733567041	E190	EHAM	EDDF	91.74391937	
732991711	B738	LKPR	EGSS	91.75069485	
718021881	E190	EHAM	EDDF	91.80359008	
697477471	P28R	EDLW	EDLN	91.84063936	
760179731	B738	EHAM	LGKL	91.94623341	
733223061	A320	GMMW	EDDL	92.07010907	
750692271	A21N	EGGW	LHBP	92.08075578	
768265911	A320	LOWW	EGSS	92.21638778	
743334921	PC12	EDDK	EGNJ	92.28943547	
694208681	PRM1	LFPB	EDDL	92.53368774	
741796511	BCS3	LKPR	EDDL	92.88752462	
730772761	B739	EHAM	LGAV	93.08262488	
699287261	B748	EHAM	EDDF	93.20642272	
727450311	A320	LEPA	EDDG	93.26137346	
708540011	A320	LEMD	EDDL	93.40918696	
771253431	A320	EHAM	EDDF	93.59937786	
763072721	A320	EHEH	LWSK	93.76445941	
748853951	B753	EDDE	EDDL	93.76656442	
744293651	B789	KDEN	EDDF	94.18762616	
751741391	B738	EHAM	LGPZ	94.2928353	
715903161	B752	EGCC	LTAI	94.45173208	
724019261	A319	EHAM	EDDF	94.65500473	
699661851	B788	KDFW	EDDF	94.79214333	
720042281	PC12	EDRY	EDLV	94.80970696	
697520531	DH8D	EKCH	ELLX	94.89429349	
701035871	A20N	EHAM	EDDF	95.17277116	
762111801	LJ40	EHRD	EDDF	95.46080631	
748322231	A320	LSZH	EDDL	95.5536395	
767002911	B78X	KORD	EDDF	95.64497217	
726737691	B738	EGCC	LCPH	96.12885654	
702349001	A320	LEAL	EDDL	96.31383827	
712610271	A321	EGCC	LCLK	96.6033178	
717961431	E190	EHAM	EDDM	96.61555821	
738237571	A320	LOWW	EGSS	96.6492673	
757526911	S22T	EDDV	EDLN	96.65469311	
699598371	C68A	LFMT	EDDL	96.90669679	
756484801	C25B	ELLX	EDDH	96.98730047	
774036881	A321	GCRR	EDDL	96.989728	
759337601	B738	EGPF	LTBS	97.99438813	
730104711	CRJ9	EHAM	EDDM	98.09730782	
751713421	A321	EHAM	EDDF	98.13813123	
763481511	E170	LFPG	EDDL	98.26930398	
701283891	BCS3	LSGG	ESGG	98.33668582	
737702991	B753	LPMA	EDDL	98.58191262	
693344001	CRJ9	EHAM	EDDF	98.60054841	
705377781	E190	LFPG	EDDL	98.62428236	
695890971	A319	EHAM	EDDF	98.75466112	
763323501	BCS3	EDDH	LFPG	99.26274441	
733818831	E190	EHAM	EDDF	99.29900346	
767003891	B77L	EBLG	ZGGG	99.33786238	
722940301	E190	EHAM	EDDF	99.40830124	
735431731	A21N	LATI	EBCI	99.58920302	
698972831	A320	LEPA	EDDL	99.65423557	
766790631	C510	EHAM	LJLJ	99.719101	
761635621	A321	EHAM	EDDF	99.85979382	
773442021	E190	EHAM	EDDF	100.01744983	
757234861	A343	KBOS	EDDF	100.15318098	
767276081	E295	EHAM	EDDF	100.22550276	
723722831	A21N	ESSA	LFPO	100.35733863	
703012411	A320	LSGG	EDDL	100.67232024	
729756821	BCS3	LEPA	EDDL	100.85911562	
697506691	A320	LEIB	EDDL	100.95144262	
711622381	A320	EDDG	LEPA	101.0570386	
718305451	B748	KLAX	EDDF	101.35659771	
767153501	A320	LOWW	EGSS	101.42313922	
766181841	E190	LFPG	EDDL	101.54307083	
707804771	E195	LPPT	EDDL	101.69143552	
721818871	A320	EGPH	LGAV	101.88177034	
735756431	B738	EHAM	LDSP	102.01424032	
740506631	C25A	EDAZ	EDLN	102.02903439	
729110731	A21N	ESSA	LFPO	102.35396072	
742748301	A320	EDDF	EDDL	102.37695283	
712753571	CRJ9	EHAM	EDDF	102.5309773	
762622891	B763	EHAM	EDDF	102.64028708	
754907251	B738	EHAM	LJLJ	102.85979121	
746665731	B789	EHAM	OEJN	102.91875968	
738772711	B738	EHAM	EDDM	103.19055744	
727789661	B753	LEJR	EDDL	103.24583216	
698398191	A319	LSGG	EDDL	103.58478168	
699203431	PC12	EDDL	EDVK	103.58996624	
725972481	A319	EHAM	EDDF	103.85767577	
696923751	B77W	EHAM	HKJK	104.1196667	
702894801	B738	EPPO	LFOB	104.21741577	
757464671	B764	EDDF	KEWR	104.26028735	
708668281	B738	EHAM	OLBA	104.3042254	
752134901	B738	EHAM	EDDM	104.81021348	
736726391	A321	LEMG	EDDL	104.91587421	
766244141	B738	EDDK	EGNT	104.96895774	
719385031	A319	LIML	EDDL	105.02428738	
735425281	B738	EGAA	LTBS	105.28485572	
693508311	BE20	LSGK	EDDL	105.38041932	
710460781	B748	EHAM	EDDF	105.41543731	
700237551	B738	GMAD	EDDG	105.620181	
738494281	B738	EGNT	LTFE	105.76662198	
761310291	A321	EHEH	LWSK	105.80546492	
736255111	B738	EGNM	LGRP	105.90243883	
737843131	A320	LEPA	EDDL	106.17349068	
724382361	A319	EHAM	EDDF	106.35555545	
740945171	E190	EHAM	EDDF	106.46154851	
747046011	A333	EGLL	LTFM	106.68129177	
695743681	A320	LEPA	EDDL	106.70748111	
768604511	A320	EHAM	EDDF	106.73008626	
753925241	BCS3	LEPA	EDDL	106.76429195	
750514291	BCS3	LEAL	EDDL	107.16907936	
756894051	A320	GCRR	EDDL	107.30734128	
757764961	B738	EHAM	LGIR	107.46693868	
698191221	B738	LPMA	EDDL	107.48834854	
733450591	PC12	LFMD	EKYT	107.61897234	
756932541	A320	LEBL	EDDL	107.72618841	
726654551	A321	LFMP	EDDL	107.960733	
760841501	A321	LEJR	EDDL	108.15045411	
740048521	A320	LFBD	EDDL	108.24294085	
714657601	B753	LEPA	EDDL	108.4456073	
700729161	E75L	EHAM	EDDF	108.70758578	
740291491	A320	EDLW	LEMG	108.74133168	
709176701	E295	EHAM	EDDF	108.83447377	
766170321	PC12	LFPB	EDDG	108.97681665	
755978591	A319	EHAM	EDDM	109.03021494	
751325521	A321	EHEH	LYBE	109.2210823	
738552491	A321	EKCH	LEPA	109.61292953	
766224141	A320	EGPH	EDDF	109.75157017	
738329431	E190	EHAM	EDDF	110.20423144	
697795461	B772	KIAH	EDDF	110.26240633	
746553231	A319	LEPA	EDDL	110.30506529	
708569811	PC24	EHAM	LSZH	110.70108299	
703652041	B77L	EHAM	EDDF	110.79397559	
739859251	A319	LEPA	EDDL	110.79627113	
699711671	A320	LEMD	EDDL	111.11092778	
739115471	A319	EHAM	EDDM	111.22013022	
713219921	A20N	EIDW	LGAV	111.31381834	
764448171	B77W	CYUL	EDDF	111.52712765	
751320361	B738	EGPF	LGRP	111.72523357	
771631531	A321	LSZH	EDDL	111.80664884	
740191111	P210	EDVE	EDLN	112.00457083	
766805731	B789	EHAM	OEJN	112.00987036	
743065481	A320	LEPA	EDDL	112.20641975	
768583561	B763	EHAM	EDDF	112.28073041	
717995071	B789	KDEN	EDDF	112.31385424	
714321711	A321	LTAI	EDDL	112.3150693	
747640061	B738	EHAM	LGKL	112.49332635	
696475911	A320	LEPA	EDDL	112.51740445	
723765101	A321	EGPF	EDDF	112.60267379	
699527561	B738	LEPA	EDDL	112.63131482	
766488701	B772	KSFO	EDDM	112.8164936	
763944431	A321	EHEH	LBSF	113.19284252	
740527401	B38M	GCLP	EDDL	113.30707915	
715585501	E190	EHAM	EDDM	113.40401249	
745426011	A320	LEAL	EDDL	113.43306734	
731900031	B738	EGPF	LTAI	113.49874226	
696977751	E190	EHAM	EDDF	113.70079976	
748942921	A319	EHAM	EDDM	113.82469911	
751505211	E190	EHAM	EDDS	113.9767643	
698955431	E190	LFPG	EDDL	114.18948367	
728327501	B738	EGNM	LTAI	114.4951798	
709059951	B738	EPMO	EBCI	114.62694764	
728590411	B738	EKCH	LFPO	114.69056171	
753952691	A21N	LPPT	EDDL	114.84069452	
773175291	A320	LPPR	EDDL	114.89289687	

11: SELECT f.flightId, f.track, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN citus.flights AS f ON eDwithin(attime(f.trip, tstzspan'[2023-03-02 05:56:59, 2023-03-03 19:42:20]'), c.geom, 1000) WHERE c.name = 'Werl' AND f.trip && tstzspan'[2023-03-02 05:56:59, 2023-03-03 19:42:20]';

flightid	track	airplanetype	origin	destination	
700682061	1	A321	EDLW	EPKT	
700995461	1	A320	EDDS	EHAM	
700984911	1	BCS3	EVRA	LFPG	
700796211	1	A319	EBBR	EDDB	
700928621	1	B738	LKPR	EHEH	
700832701	1	B738	EDLW	EPKT	
700874691	1	A321	EDDM	EHAM	
700859811	1	A320	EFHK	LFPG	
700734111	1	A319	EDDG	EDDM	
700836411	2	B738	HEGN	EHAM	
700882241	1	A320	LIRF	EHAM	
700975821	1	A359	EDDM	KSFO	
700885031	2	B738	EDDM	EHAM	
700682911	1	A320	EHEH	LBWN	
700844301	1	B738	EDDK	EKBI	
700806951	2	B738	LGAV	EHAM	
700899361	1	B38M	LBSF	EHEH	
700863481	1	B738	EPMO	EBCI	
700779371	2	A21N	LHBP	EHEH	
700839731	1	A320	EGGW	LRSV	
700680821	1	BCS3	EVRA	LFPG	
700674841	1	E195	EPWA	EBBR	
700694621	1	A319	EBBR	EDDB	
700730441	2	PA44	EDLW	EDVK	
700896651	1	A321	EHEH	EPKK	
700675491	1	BCS3	EVRA	GCTS	
700724811	1	A319	EDDB	EBBR	

12: SELECT b.name, COUNT (*) FROM citus.flights f, districts b WHERE f.trip && stbox(b.geom, timestamptz'2023-05-07 22:00:58') AND eintersects(attime(f.trip, timestamptz'2023-05-07 22:00:58'), b.geom) GROUP BY b.name;

name	count	
Rbz Arnsberg	8	
Rbz Koeln	11	
Rbz Detmold	5	
Rbz Muenster	4	
Rbz Duesseldorf	7	

13: SELECT f.flightId, f.track, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN citus.flights AS f ON eDwithin(attime(f.trip, tstzspan'[2023-06-27 02:50:19, 2023-06-28 02:08:00]'), c.geom, 1500) WHERE c.name = 'Gladbeck' AND f.trip && tstzspan'[2023-06-27 02:50:19, 2023-06-28 02:08:00]';

flightid	track	airplanetype	origin	destination	
728463591	1	A319	EDDL	LDZA	
728402661	1	C25A	EDDW	LPCS	
728541681	1	C550	EDDL	EDDG	
728567450	1	P46T	EDTF	EDLD	
728593301	1	B38M	EHEH	EPKK	
728474921	1	DA42	EDLE	EDLW	
728420061	1	A319	EGLL	EDDL	
728464861	1	A20N	LTFJ	EHEH	
728466891	1	A321	EHEH	LYBE	
728615151	1	A320	LGIR	EGPH	
728406461	1	A320	EDDL	EDDB	
728532891	1	A21N	EHEH	EPWA	
728604751	1	B738	LKPR	EHEH	
728509051	1	A319	EIDW	EDDL	
728520531	1	A319	EDDL	EDDB	
728439791	1	B38M	EHEH	EPMO	
728458771	1	CL35	EHAM	EDDK	
728395401	1	A320	EDDL	ORER	
728497311	1	A320	LROP	EHEH	
728498521	1	BCS3	EGLL	EDDL	
728538511	1	A321	LKPR	EGGW	
728580281	1	DA42	EDLE	EDLW	
728419771	1	B738	ENGM	LEPA	
728483651	1	A320	ESSA	LEMG	

14: SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.traj, ST_GeogFromText('SRID=4326;POINT(7.365475485030469 51.44282685124891)')) AS min_distance FROM citus.flights f WHERE ST_DWithin(f.traj, ST_GeogFromText('SRID=4326;POINT(7.365475485030469 51.44282685124891)'), 115)   ORDER BY min_distance ASC;

flightid	airplanetype	origin	destination	min_distance	
730352491	A320	EDDM	EDDL	2.51948621	
756942731	A320	EDDM	EDDL	6.92577172	
770837991	A21N	EHEH	LHBP	7.18990445	
699460191	A319	EDDB	EBBR	11.61095222	
696378581	BE20	EDAZ	EDLN	14.12205987	
753584421	B38M	EPWA	EBBR	17.75347715	
765832461	A320	LIML	EDDL	18.80893487	
759887951	B738	EHAM	LLBG	19.35977694	
760421801	B738	EDDB	EBBR	21.3295172	
772744721	B738	LTAC	EDDL	23.46561051	
714059731	A20N	EDDH	LPPT	24.20060119	
702286891	A339	LLBG	KJFK	25.14213233	
729084101	SR22	EDAZ	EDLE	26.99742045	
729145291	B788	VIDP	EGLL	28.11127335	
755023021	B77L	ZHCC	EBLG	29.07272981	
727260601	E195	EPWA	EBBR	29.17882729	
762289801	E195	EPWA	EBBR	29.36171065	
708512131	B738	EDDB	EBBR	29.41180494	
695453161	B38M	EPWA	EBBR	30.64371767	
711142391	B738	EDDB	EBBR	31.09414669	
709951971	B738	EDDB	EBBR	31.55544747	
746676431	B738	LTAI	EDDL	32.21954485	
729204351	A320	BKPR	EDDL	32.57940235	
752454771	A319	EDDB	EBBR	33.3153166	
718877461	B738	EPMO	EBCI	33.68760243	
752426431	A320	EDDB	EBBR	33.76361596	
719632051	A319	EPKK	EDDL	35.36781404	
723261781	B38M	LIBD	EDLV	35.64995808	
741107611	B738	EKCH	LEPA	37.94827303	
745255931	A21N	LTFJ	EDDL	38.79078666	
694001181	E190	EDDV	LFPG	38.90326104	
764744221	E170	EDDV	LFPG	41.0610974	
718650571	A319	EDDB	EBBR	41.19894678	
734314921	B38M	EPMO	EBCI	41.55440589	
743498071	E190	EDDH	LFPG	41.59367805	
726577161	CRJ9	EDDB	EBBR	43.39281668	
743576661	A320	LKPR	EDDL	44.65951531	
731442371	B738	EDDB	EBBR	44.81357426	
708745561	A320	EDDB	EBBR	45.1160561	
773901261	B738	EDDV	EBLG	45.94671225	
698050631	SR20	EDLW	EDLN	45.96096336	
718943171	TB21	EDAZ	EDLE	47.31342503	
722605360	C525	EGHI	EDLW	48.53722441	
697738791	BCS1	LSZH	EDDL	48.80683733	
763036501	A319	EYVI	EBBR	49.07115893	
727327661	B738	LTAS	EDDL	49.77232062	
725180000	P28R	EDLN	EDLW	49.8182193	
699097011	PA44	EDLW	EDDL	50.85306781	
709829301	A319	EDDB	EBBR	51.6213333	
735920571	A320	LEMH	EDDL	51.64081217	
702255981	B738	EDDB	EBBR	51.94678616	
716008921	B738	ESSA	LEBL	52.15510575	
709084161	C172	EDLE	EDDP	53.50577091	
758394301	A320	LKPR	EDDL	53.59244476	
708964891	BCS3	LGTS	EDDL	53.59842106	
748558021	B738	EDLV	LGTS	54.07970982	
716785511	A319	EDDB	EBBR	54.22633793	
766559771	B738	LGAV	EHEH	54.79119068	
702161001	A320	EDDB	EBBR	55.23922828	
745841841	B738	LTAC	EDDL	56.18037009	
726556681	A319	EDDB	EBBR	56.86806845	
721304321	B38M	EPMO	EBCI	58.22876873	
773893691	A320	HEGN	EDDL	59.28348874	
707452720	SR22	EDDG	EDLW	59.77461871	
711148951	A320	EDDB	EBBR	59.87664782	
718527931	C56X	EDDB	EBBR	60.28172454	
709004121	A320	OLBA	EDDL	60.38564886	
767586471	A320	EDDM	EDDL	60.6244959	
718539421	BE20	EPSY	EBLG	61.43855753	
711424421	E75S	EPWA	EBBR	61.52879119	
707897071	A320	EDDB	EBBR	61.94300334	
716237491	DA42	EDLE	EDLW	62.00943004	
717023531	B738	LGRP	EHEH	63.05125403	
743771531	A319	LIPX	EDDL	63.15908967	
723459331	A320	EDDB	EBBR	63.17616588	
734982871	B38M	LIEE	EDLV	63.21463905	
766459891	DH8D	ELLX	ESSA	64.04494104	
702200641	A321	EDDM	EDDL	64.14752688	
766084101	A320	LKPR	EDDL	64.48450726	
702783931	B738	LTFJ	EDDL	65.22696821	
730148441	A333	EBBR	EFHK	65.5342158	
709588451	A319	EDDB	EBBR	65.7483887	
726772761	AT72	EDDK	EYKA	66.00190573	
720688101	B738	EGSS	EDLW	66.40006849	
694485571	E75S	EPWA	EDDL	67.28388433	
743937401	A21N	LHBP	EHEH	67.50124266	
768516091	A20N	EKCH	LFPG	67.57487292	
722634831	A319	EDDB	EBBR	67.71775129	
739368241	B738	EKCH	LEBL	67.88850236	
721576411	B738	EDDB	EBBR	68.25407598	
747430611	B738	EDDB	EBBR	69.01678161	
773036891	GALX	LIMP	EDDL	69.15407789	
700811781	B738	EDDB	EBBR	69.22338632	
726420691	A20N	LGIR	EDDL	70.33452821	
740497111	E55P	EHAM	LKMT	70.50938844	
696804930	P28A	EDLW	EDLW	70.62368275	
772019250	C152	EDDG	EDDG	71.68724759	
701650801	A332	LTFM	EDDL	71.77400847	
724011321	A319	EDDB	EBBR	72.75415487	
710256191	E195	EPWA	EBBR	73.18202019	
717990031	A319	EDDB	EBBR	73.24732753	
723001871	A319	EDDB	EBBR	73.401103	
700256251	A319	EDDB	EBBR	73.47035561	
757131401	B77W	ZBAA	LFPG	73.5089184	
761581481	B738	LCLK	EGNM	74.1397874	
732536701	A320	LGKR	EDDL	74.77094499	
728628771	B738	EPMO	EBCI	74.78092381	
760877851	A320	EDDB	EBBR	74.85995304	
774366281	A320	LOWW	EIDW	75.34112492	
696897460	PA44	EDLW	EDLW	75.96257333	
719804341	C340	EDLW	EDLW	76.11410875	
702867941	PA44	EDLP	EDLE	76.38942521	
693338111	C425	EDDL	EDDV	77.14293593	
694870411	B738	EDDV	LEBL	77.19729724	
705207681	B38M	HEMA	EDDL	77.64550174	
715453471	F2TH	EDDB	EBBR	77.70375888	
723332400	M20P	EDKA	EDLW	77.75408488	
760868331	B738	EDDB	EBBR	77.98671376	
697132831	A320	LEBL	EDDV	78.25663606	
730660261	A20N	HEGN	EDDL	78.35441635	
729276081	A319	EYVI	EBBR	78.75765975	
732167331	A319	EDDB	EBBR	78.79941142	
731821031	A21N	LTFM	EDDL	78.85841906	
709764281	B738	EDDB	EBBR	78.98587623	
718587151	A321	LOWW	EDDL	79.23308898	
770285321	B77W	EDDF	KIAD	79.53738501	
726446981	A20N	LTAI	EDDL	79.71116857	
745200831	B738	LGKR	EDDL	79.82852894	
754231291	A321	LDSP	EDDL	79.93316514	
753219761	B738	EPMO	EBCI	79.93897049	
724504500	P28A	EDLE	EDLW	81.73914332	
758765671	B38M	LTBJ	EDDL	81.86484424	
750073431	A320	DTMB	EDDL	82.23654628	
734644101	A319	LKPR	EGBB	82.79984506	
748960681	A320	EKCH	LSGG	83.24875225	
760128390	P28B	EDLD	EDLW	83.48260655	
761298711	B738	EDDW	LEPA	83.59882938	
699910941	B738	EKCH	LFLL	83.80803749	
762424041	A320	HEGN	EDDL	84.62457142	
726556851	B738	EGSS	EDLW	84.73663957	
764386881	A321	LTFM	EDDL	84.9387414	
747329861	B738	LTAI	EGNM	85.65790596	
728977911	A320	EDDH	LEPA	85.82059484	
772618101	A320	EDDF	EHAM	86.0842388	
705945000	BE20	EDXW	EDLW	86.14834539	
710949150	P28R	EDLN	EDLW	87.69097689	
709224611	A319	EDDB	EBBR	87.92894835	
706664451	A320	LSZH	EDDL	88.25239616	
694080151	E195	EPWA	EBBR	88.25623058	
707966531	A319	EDDB	EBBR	88.54373725	
753997491	B738	LTAI	EDDL	89.0510357	
696597211	A346	EDDF	CYVR	89.36133708	
710181521	DH8D	EDDH	ELLX	89.42613786	
719356620	P28R	EDLN	EDLW	90.04389923	
736484481	A320	DTTJ	EDDL	90.31912647	
769668731	A320	EDDB	EBBR	90.52275604	
773200491	B738	EDLW	LEPA	90.74001833	
693797671	A319	EDDB	EBBR	91.16526766	
765575141	A320	LGIR	EDDL	91.37602657	
724504501	P28A	EDLE	EDLW	91.40828987	
748313101	E195	EPWA	EBBR	91.62838241	
703759681	A320	EDDG	EDDK	91.695113	
745190071	B738	EPMO	EBCI	92.38257971	
715107171	A321	LWSK	EHEH	93.03763141	
711158911	E75S	EPWA	EBBR	93.19959567	
760057741	B744	EDDF	CYYZ	93.20684215	
763561191	E190	EPWA	EBBR	93.70262093	
722504611	PA44	EDLN	EDLW	93.95438735	
724820711	PA46	EDDH	EDLW	93.98322239	
705222071	B752	EDDV	LFPG	94.68813866	
766699201	E190	LFPG	EDDV	95.00788647	
728201391	CL60	EGKB	EDDG	95.03529847	
717718201	C56X	EPPO	EDDL	95.72939148	
712803181	A320	LGKO	EDLV	95.87624466	
722820241	B38M	LGRP	EDLV	96.08001844	
755493691	B38M	LTFE	EIDW	96.65126065	
761095261	B38M	EKCH	LEBL	97.24473989	
767681091	CL35	EDDN	EDDL	97.27103245	
767178161	A320	EDDF	EHAM	98.02625618	
711240961	A319	EDDB	EBBR	98.04800579	
707075910	TB21	EDVE	EDLW	98.62952641	
713101681	A320	EDDB	EBBR	98.78955321	
768467171	E190	EPWA	EDDL	98.92012374	
732017971	BCS3	LOWW	EDDL	99.46386279	
761297851	A319	EDDM	EDDL	99.74676004	
697446691	B38M	EPMO	EBCI	100.42538291	
766531661	E190	EBBR	EFHK	100.43612005	
745146381	E75S	EPWA	EBBR	100.63585326	
765796551	A320	EYVI	EBBR	100.77208088	
702358281	A21N	LTFJ	EDDL	101.41905352	
731615931	A320	LGKO	EDDL	102.02150526	
748928111	B738	EKCH	LIEA	103.01249242	
703510721	PA44	EDLW	EDLN	103.78709557	
745489911	B738	LTAI	EDDL	103.87528565	
732454821	A320	LTBS	EGAA	104.04600846	
720942481	A319	EDDB	EBBR	104.26742077	
741344071	B789	RJTT	EDDM	104.29817902	
702064361	BE9L	EHLE	EDLW	104.87164089	
705125431	PA44	EDLE	EDLP	105.11475793	
700247551	CRJ9	ESSA	EDDL	105.23621845	
768405981	A320	LIMC	EDDL	105.30876882	
716244021	A333	EDDF	KSEA	105.3530592	
772931091	DH8D	ELLX	EKCH	105.52409507	
773223181	A320	EHEH	LBWN	105.83496209	
719800041	A320	EDDL	EDDB	106.13486195	
710613450	DA42	EDLE	EDLW	106.25590164	
721122550	DA42	EHGG	EDLW	106.31598992	
700488281	PC12	EDDL	EDJA	106.46073963	
744118261	B738	LGRP	EHBK	106.49993237	
723396411	B789	EHAM	RKSI	107.01352542	
729900971	B763	LSZH	KORD	107.12974247	
764986881	B38M	EPMO	EBCI	107.32101082	
705937761	C68A	BIRK	LDDU	107.67476018	
769816651	LJ45	EDDB	EBLG	107.98243796	
706818071	DH8D	ELLX	EKCH	108.19809797	
742892920	M20P	EDKA	EDLW	108.67422392	
746077951	A319	EYVI	EBBR	108.8249332	
720110331	B738	EDDB	EBBR	108.89829223	
696484431	A21N	LTFM	EDDL	109.28844658	
733896861	A320	LOWW	EDDL	109.30470597	
692900831	A388	OMDB	EDDL	109.89129417	
719294570	PA34	EDHL	EDLW	110.7070152	
732214821	DH8D	ELLX	ESSA	110.96334369	
710170931	B789	EDDF	KDTW	110.97724048	
700541531	SR20	EDLN	EDLW	111.21224302	
708820321	B77L	EBLG	ZSPD	111.50043136	
708330471	CRJX	LIML	EDDL	111.80117855	
771381751	A320	LTFJ	EDDL	112.00524063	
728463021	A320	EDDH	LEPA	112.53739854	
723722881	A320	EDDL	EDDB	113.14475846	
759861191	AT76	LFLL	ESGG	113.22078091	
730570251	A320	EDDH	LEPA	113.40011888	
767077891	A20N	EHAM	LKPR	113.57747363	
696544151	B738	LTAC	EDDL	113.74280011	
732699041	A320	EDDH	LEPA	113.81976793	
737874371	A319	EDDB	EBBR	113.94674875	
740526171	B738	LIME	EDLV	113.96867099	
707484270	SR22	EDLW	EDLN	114.00459314	
737197841	B738	ENBR	LIME	114.12725282	
727486861	A320	LBSF	EGGW	114.1872311	
707606191	A320	BIKF	LIMC	114.48177571	
770759741	B38M	EKCH	LEAL	114.56922792	
738325711	E75S	EPWA	EBBR	114.73702514	
710623581	A20N	EDDH	LPFR	114.94782082	

15: SELECT COUNT(*), tstzspan'[2023-07-28 15:16:33, 2023-08-11 14:00:31]' FROM citus.flights f WHERE f.trip && tstzspan'[2023-07-28 15:16:33, 2023-08-11 14:00:31]';

count	tstzspan	
83173	[2023-07-28 15:16:33+02, 2023-08-11 14:00:31+02]	

16: SELECT k.name, COUNT(*) as flight_count FROM counties k JOIN citus.flights f ON f.traj && k.geom WHERE k.name = 'Krs Rhein-Sieg-Kreis' AND st_intersects(f.traj, k.geom) GROUP BY k.name;

name	flight_count	
Krs Rhein-Sieg-Kreis	314575	

17: SELECT f.flightId, f.track, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN citus.flights AS f ON eDwithin(attime(f.trip, tstzspan'[2023-12-24 10:00:00, 2023-12-24 23:59:59]'), c.geom, 2500) WHERE c.name = 'Ennepetal' AND f.trip && tstzspan'[2023-12-24 10:00:00, 2023-12-24 23:59:59]';

flightid	track	airplanetype	origin	destination	
773155001	1	B738	EHAM	LOWW	
773164401	1	A320	EHAM	LBSF	
773199021	1	B38M	EBBR	EDDB	
773169061	1	DH8D	ELLX	ESSA	
773185421	1	A321	LZTT	EGGW	
773177501	1	A320	BIKF	DTTA	
773234911	1	A388	KJFK	OMDB	
773220881	1	B738	EHEH	LKPR	
773158381	1	B738	EHAM	LTAN	
773198921	1	B772	EGLL	OBBI	
773194841	1	B788	EGLL	VABB	
773173191	1	A319	EDDB	EBBR	
773174961	1	B77L	EBLG	ZGGG	
773185441	2	A319	EDDH	LFPG	
773154571	1	A319	EBBR	EDDB	
773152851	2	A320	EDDW	GCLP	
773191421	1	B738	EHAM	HEGN	
773208201	1	A320	EFHK	LFPG	
773190631	1	CRJ9	EDDM	EDDL	
773203411	1	A319	LKPR	EGGW	
773156041	1	A21N	LKPR	EGGW	

18: SELECT b.name, COUNT (*) FROM citus.flights f, districts b WHERE f.trip && stbox(b.geom, timestamptz'2023-09-06 08:18:07') AND eintersects(attime(f.trip, timestamptz'2023-09-06 08:18:07'), b.geom) GROUP BY b.name;

name	count	
Rbz Arnsberg	8	
Rbz Koeln	12	
Rbz Detmold	5	
Rbz Muenster	4	
Rbz Duesseldorf	9	

19: SELECT g.name, f.flightid, f.origin, f.destination, f.airplanetype, duration(whenTrue(attime(f.altitude, tstzspan'[2023-11-11 10:46:18, 2023-11-11 18:59:34]') #< 1540 & tintersects(tgeompoint(attime(f.trip, tstzspan'[2023-11-11 10:46:18, 2023-11-11 18:59:34]')), geometry(g.geom)))) AS totalTimeBelowAltitude FROM municipalities g JOIN citus.flights f ON f.trip && stbox(g.geom, tstzspan'[2023-11-11 10:46:18, 2023-11-11 18:59:34]') AND eintersects(attime(f.trip, tstzspan'[2023-11-11 10:46:18, 2023-11-11 18:59:34]'), g.geom) WHERE g.name = 'Gem Ascheberg' AND duration(whenTrue(attime(f.altitude, tstzspan'[2023-11-11 10:46:18, 2023-11-11 18:59:34]') #< 1540 & tintersects(tgeompoint(attime(f.trip, tstzspan'[2023-11-11 10:46:18, 2023-11-11 18:59:34]')), geometry(g.geom)))) IS NOT NULL;

name	flightid	origin	destination	airplanetype	totaltimebelowaltitude	
Gem Ascheberg	765429881	EDLE	EDDG	C172	00:02:20	

20: SELECT f.flightid, f.track FROM citus.flights f, counties k WHERE k.name = 'Krs Muelheim a.d. Ruhr' AND f.trip && stbox(k.geom, tstzspan'[2023-04-17 02:35:04, 2023-04-17 18:09:02]') AND eintersects(attime(f.trip, tstzspan'[2023-04-17 02:35:04, 2023-04-17 18:09:02]'), k.geom);

flightid	track	
710120591	1	
710122791	1	
710140911	1	
710154691	1	
710160461	1	
710162321	2	
710167691	1	
710168441	1	
710176661	1	
710187870	1	
710190721	1	
710240091	1	
710246041	1	
710254811	1	
710133201	1	
710152481	1	
710161381	1	
710176861	1	
710189171	1	
710222521	1	
710196900	3	
710246751	1	
710250661	1	
710250410	3	
710153271	1	
710182001	1	
710189371	1	
710214801	1	
710118421	1	
710119121	1	
710122341	1	
710137311	2	
710224561	1	
710232951	1	
710252941	1	
710121991	1	
710134061	1	
710214741	1	
710216061	1	
710216681	1	
710247341	1	
710139021	1	
710128541	1	
710133741	1	
710138691	1	
710169280	2	
710179031	1	
710203630	3	
710248021	1	
710117941	1	
710123931	1	
710176991	1	
710190061	1	
710204151	1	
710172291	1	
710180801	1	
710185841	1	
710152721	1	
710170901	2	
710173421	1	
710175091	1	
710188891	1	
710135961	2	
710205221	1	
710122981	1	
710128371	1	
710132341	1	
710136651	1	
710147661	1	
710138201	2	
710149411	1	
710235611	1	
710206751	1	
710130061	1	
710135511	1	
710227941	1	
710256900	1	
710262791	1	
710124121	1	
710148381	1	
710191881	1	
710200991	1	
710202761	1	
710261101	1	
710129101	1	
710153391	2	
710160090	4	
710183551	1	
710200440	1	
710203241	1	
710227001	1	
710232530	3	
710255011	1	
710118091	1	
710192321	1	
710131531	1	
710172301	1	
710242531	1	
710252681	1	
710120221	1	
710154381	2	
710176101	1	
710245071	1	
710124261	1	
710157751	1	
710171751	1	
710220391	1	
710236491	2	
710241341	1	
710244851	1	
710245511	2	
710115531	1	
710117611	1	
710129341	1	
710177281	1	
710186931	1	
710187371	1	
710193771	1	
710251151	1	
710119841	1	
710120091	1	
710120131	1	
710174951	1	
710180931	1	
710182041	1	
710211651	1	
710227281	1	
710236740	1	
710239611	1	
710240471	1	
710247581	1	
710148821	2	
710218541	1	
710220851	1	
710224640	3	
710224640	4	
710252781	1	
710261461	1	
710162111	1	
710165971	1	
710167281	1	
710194401	1	
710137081	1	
710236851	1	
710239911	1	
710261641	1	
710118871	1	
710154501	2	
710158921	1	
710163161	1	
710131201	1	
710153791	1	
710169931	1	
710216511	1	
710134381	1	
710186691	1	
710260331	1	
710122441	1	
710128231	1	
710141511	1	
710159301	1	
710235641	1	
710141551	1	
710156131	1	
710165891	1	
710178401	1	
710224151	1	
710257381	1	
710122841	1	
710125901	1	
710126711	1	
710129671	1	
710134851	1	
710146921	1	
710154471	1	
710161141	1	
710164361	1	
710175221	1	
710182251	1	
710215931	2	
710237771	1	
710251141	1	
710119251	1	
710117641	1	
710122821	1	
710138241	1	
710141831	3	
710161741	1	
710191811	1	
710206131	1	

21: WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM citus.flights f WHERE f.trip && tstzspan'[2023-02-17 22:18:10, 2023-02-27 21:50:27]' GROUP BY f.origin), arrivals AS ( SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM citus.flights f WHERE f.trip && tstzspan'[2023-02-17 22:18:10, 2023-02-27 21:50:27]' GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals, COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count FROM departures d FULL JOIN arrivals a ON d.airport = a.airport ORDER BY traffic_count DESC, departures DESC, arrivals DESC;

airport	departures	arrivals	traffic_count	
EDDL	3076	3038	6114	
EDDK	2262	2137	4399	
EHAM	1809	1649	3458	
EGLL	1401	1504	2905	
EDDF	1389	1313	2702	
EDDM	1024	1020	2044	
EDDB	697	422	1119	
EGSS	555	544	1099	
EDLW	546	516	1062	
EBBR	377	632	1009	
LOWW	521	474	995	
EGGW	494	415	909	
EIDW	425	384	809	
EGCC	459	336	795	
LTFM	462	314	776	
EDDH	429	288	717	
OMDB	354	284	638	
LTFJ	332	294	626	
LFPG	179	425	604	
EDDG	289	295	584	
LKPR	289	285	574	
EKCH	310	225	535	
LEPA	242	276	518	
EHEH	246	266	512	
LSZH	165	319	484	
EDDP	217	255	472	
EPKK	230	239	469	
EPWA	240	224	464	
LROP	244	219	463	
OTHH	222	222	444	
LOWS	168	254	422	
EGKK	234	177	411	
EDDV	222	185	407	
EGBB	208	183	391	
LHBP	108	270	378	
EDLN	174	201	375	
GCLP	176	179	355	
EDLV	175	179	354	
EDLP	173	181	354	
EGNX	164	171	335	
LTAI	150	174	324	
EPKT	145	154	299	
LLBG	138	151	289	
LBSF	152	126	278	
GCTS	129	149	278	
LEBL	116	162	278	
LIRF	123	140	263	
ESSA	143	115	258	
EGLC	126	130	256	
LEMD	105	149	254	
EBCI	61	184	245	
LOWI	79	165	244	
HEGN	115	123	238	
EGPH	128	106	234	
KJFK	103	114	217	
EPWR	102	107	209	
EDDW	110	97	207	
LIMC	71	133	204	
EFHK	125	76	201	
ENGM	108	91	199	
WSSS	96	100	196	
GCFV	83	109	192	
LPPT	80	112	192	
OMAA	105	85	190	
LEMG	85	105	190	
VIDP	92	92	184	
KORD	76	106	182	
LGAV	89	88	177	
LIPZ	81	81	162	
LIME	74	85	159	
EDLE	88	69	157	
LIML	80	76	156	
CYYZ	65	90	155	
EGGD	79	70	149	
KEWR	71	75	146	
EBLG	91	51	142	
LRCL	70	70	140	
EDDS	59	80	139	
EDDN	67	71	138	
VABB	65	72	137	
EHRD	95	39	134	
LDZA	74	60	134	
LSGG	65	68	133	
LYBE	65	65	130	
KIAD	61	67	128	
EPPO	65	62	127	
EPMO	65	59	124	
VHHH	57	65	122	
LIPE	63	56	119	
LGTS	60	56	116	
LEAL	43	68	111	
RKSI	58	52	110	
HECA	63	46	109	
EGNM	59	48	107	
GCRR	48	58	106	
KSDF	51	50	101	
EPRZ	53	45	98	
LTBJ	48	49	97	
LUKK	47	48	95	
BKPR	45	48	93	
LFSB	24	69	93	
KSFO	48	44	92	
LPFR	46	46	92	
VTBS	42	49	91	
EVRA	52	36	88	
EGGP	55	32	87	
LZIB	48	37	85	
OBBI	42	43	85	
EPGD	46	38	84	
LTAC	44	40	84	
KATL	41	42	83	
BIKF	48	34	82	
EGNT	42	40	82	
EGKB	43	38	81	
EKBI	37	44	81	
ELLX	34	46	80	
LFLL	33	47	80	
LFMN	35	44	79	
EGLF	50	27	77	
EDDC	39	38	77	
LIRN	35	42	77	
LSZR	29	46	75	
LCLK	25	50	75	
EDKB	29	44	73	
EYVI	37	35	72	
LATI	37	33	70	
LPMA	31	39	70	
LCPH	30	39	69	
EHBK	20	49	69	
LBWN	35	33	68	
LRIA	33	34	67	
LEVC	31	33	64	
OJAI	34	29	63	
KIAH	33	30	63	
KLAX	35	27	62	
EGPF	31	31	62	
LFPO	11	51	62	
RJTT	21	39	60	
LPPR	30	29	59	
EINN	28	30	58	
LRSV	26	32	58	
LTAU	28	28	56	
ESGG	24	32	56	
OLBA	29	26	55	
LWSK	27	27	54	
EYKA	26	28	54	
ESMS	24	30	54	
KDEN	24	30	54	
EDNY	26	27	53	
CYUL	21	32	53	
OMDW	33	18	51	
KDFW	29	21	50	
KBOS	27	23	50	
WMKK	26	23	49	
EDXW	25	24	49	
LOWG	24	25	49	
HEMA	24	24	48	
KCLT	23	25	48	
LDSP	22	25	47	
HKJK	32	14	46	
VOBL	30	16	46	
KPHL	28	18	46	
KCVG	26	20	46	
EBOS	23	22	45	
LEVT	21	24	45	
KMIA	25	19	44	
OKBK	21	23	44	
EDGS	21	23	44	
UBBB	25	18	43	
LZKZ	22	21	43	
ZZZZ	21	22	43	
EDMA	22	19	41	
KMEM	17	24	41	
LRCV	19	20	39	
EDVK	17	22	39	
LQTZ	19	19	38	
EDMO	19	19	38	
EPLB	18	20	38	
EBAW	16	22	38	
LRTR	20	17	37	
GMMX	17	19	36	
EDAZ	20	14	34	
EDVE	19	15	34	
OEJN	14	20	34	
KDTW	17	16	33	
EDLI	14	19	33	
HESH	8	25	33	
MMUN	15	17	32	
EDDR	13	19	32	
LSZS	15	16	31	
EDFH	12	19	31	
LSGS	11	20	31	
LRSB	15	15	30	
EPLL	14	16	30	
LFBO	8	22	30	
GMMW	15	14	29	
MMMX	10	19	29	
OERK	9	20	29	
LFPB	9	20	29	
LJLJ	14	14	28	
LICC	9	19	28	
ORER	15	12	27	
LFML	12	15	27	
EDTY	14	12	26	
VOHS	14	12	26	
LBPD	12	14	26	
EDHI	21	4	25	
ZGGG	16	9	25	
LIBD	12	13	25	
LFRN	11	14	25	
GMAD	12	12	24	
RCTP	12	12	24	
LOWK	10	14	24	
LKMT	9	15	24	
UAAA	11	12	23	
LYNI	11	12	23	
LYPG	11	12	23	
LKTB	10	13	23	
LIRQ	10	13	23	
ENTC	12	10	22	
EPBY	18	3	21	
MDLR	13	8	21	
EFRO	12	9	21	
EGWU	11	10	21	
VRMM	10	11	21	
EDVY	10	11	21	
LMML	10	11	21	
LIPX	9	12	21	
EDFM	8	13	21	
ENZV	5	16	21	
LIRP	5	16	21	
RJAA	17	3	20	
VOMM	12	8	20	
EDLD	12	8	20	
LIPB	11	9	20	
VGSY	10	10	20	
OMSJ	10	10	20	
EDSB	6	14	20	
ENBR	5	15	20	
LTAF	9	10	19	
KMCO	9	10	19	
LSZC	8	11	19	
ZGSZ	5	14	19	
EDLA	14	4	18	
EETN	11	7	18	
VCBI	11	7	18	
OPIS	10	8	18	
OOMS	10	8	18	
LRTM	9	9	18	
CYVR	7	11	18	
LIMF	2	16	18	
LFOB	1	17	18	
VVNB	10	7	17	
YPPH	10	7	17	
LTCG	9	8	17	
LRBC	8	9	17	
LEIB	8	9	17	
LEBB	8	9	17	
MDPC	8	9	17	
ESNX	11	5	16	
HAAB	11	5	16	
UGTB	10	6	16	
EDKA	10	6	16	
LTFH	8	8	16	
LTAS	8	8	16	
EDKM	8	8	16	
LEJR	8	8	16	
KIND	8	8	16	
EDLM	6	10	16	
EGAA	10	5	15	
GVAC	9	6	15	
GCLA	9	6	15	
EDTL	9	6	15	
OJAQ	8	7	15	
EHGG	8	7	15	
EDFE	7	8	15	
VOGO	7	8	15	
DTTA	7	8	15	
LTBA	7	8	15	
EGHH	7	8	15	
KSEA	7	8	15	
LHDC	4	11	15	
EDWO	10	4	14	
LEZL	8	6	14	
MKJS	7	7	14	
OPLA	7	7	14	
LEAS	6	8	14	
EDJA	5	9	14	
ZSPD	4	10	14	
HUEN	13	0	13	
EDQM	8	5	13	
EFKT	8	5	13	
LFMT	8	5	13	
EPSY	7	6	13	
VAAH	6	7	13	
LSZB	5	8	13	
CYYC	5	8	13	
ETNG	5	8	13	
LOWL	9	3	12	
LFMP	8	4	12	
EICK	7	5	12	
UGKO	6	6	12	
VVTS	6	6	12	
GMFF	6	6	12	
LQBK	6	6	12	
GMME	6	6	12	
GMTT	6	6	12	
EDWF	6	6	12	
LIPH	4	8	12	
EDRZ	3	9	12	
LFLS	2	10	12	
ESSB	9	2	11	
ESPA	7	4	11	
EDFB	6	5	11	
LTBS	3	8	11	
HRYR	3	8	11	
ZUUU	8	2	10	
KGSP	7	3	10	
ZSHC	5	5	10	
LRCK	5	5	10	
EPLS	4	6	10	
LTAJ	4	6	10	
GVBA	0	10	10	
HTDA	9	0	9	
LIPO	7	2	9	
UATG	5	4	9	
EGHI	5	4	9	
EDDE	5	4	9	
UTTT	5	4	9	
LSGK	4	5	9	
ZHCC	4	5	9	
LFQQ	4	5	9	
LQSA	4	5	9	
LRBS	3	6	9	
OEDF	7	1	8	
EGPD	5	3	8	
LWOH	4	4	8	
EGVN	4	4	8	
DTTJ	4	4	8	
UATE	4	4	8	
ESNQ	4	4	8	
KSTL	4	4	8	
OIIE	4	4	8	
LBBG	3	5	8	
ETNL	2	6	8	
ETAR	0	8	8	
LIRA	0	8	8	
HTKJ	0	8	8	
ENTO	6	1	7	
LFBD	5	2	7	
OMAD	5	2	7	
EDKV	5	2	7	
EDRK	4	3	7	
UDYZ	4	3	7	
VTSP	4	3	7	
EDFZ	4	3	7	
EKRK	4	3	7	
LRSM	4	3	7	
VOCI	4	3	7	
EGSH	4	3	7	
LIBR	3	4	7	
KAUS	3	4	7	
LDDU	3	4	7	
EKAH	3	4	7	
KSAN	3	4	7	
TBPB	2	5	7	
KTEB	2	5	7	
DTMB	2	5	7	
ZBAA	6	0	6	
KDOV	6	0	6	
GOBD	6	0	6	
EFTU	6	0	6	
EDLS	6	0	6	
EDVM	5	1	6	
OKKK	5	1	6	
LTCA	4	2	6	
LFLB	4	2	6	
EHBD	4	2	6	
LTBY	4	2	6	
LFST	4	2	6	
EGMD	4	2	6	
HELX	4	2	6	
KBWI	4	2	6	
LPCS	4	2	6	
LOIJ	4	2	6	
LROD	3	3	6	
KRFD	3	3	6	
LZTT	3	3	6	
EKOD	3	3	6	
LICJ	2	4	6	
EDGE	2	4	6	
GCXO	2	4	6	
EDBN	2	4	6	
LFPN	2	4	6	
EGMC	2	4	6	
ZHHH	1	5	6	
CYHM	0	6	6	
EDRY	0	6	6	
LIMJ	0	6	6	
EBKT	5	0	5	
CYHZ	5	0	5	
MMGL	5	0	5	
EGTE	4	1	5	
EGTK	4	1	5	
UACC	4	1	5	
EGNS	4	1	5	
CYYT	3	2	5	
LTFE	3	2	5	
EDHK	3	2	5	
LTCC	3	2	5	
MPTO	2	3	5	
KFLL	2	3	5	
OTBD	2	3	5	
EPSC	2	3	5	
LFAV	2	3	5	
VIAR	2	3	5	
ETND	1	4	5	
MDPP	1	4	5	
EDXR	4	0	4	
GABS	4	0	4	
EDVI	4	0	4	
LESB	4	0	4	
ESMQ	4	0	4	
LTAN	3	1	4	
EGNJ	3	1	4	
MROC	3	1	4	
EDFV	2	2	4	
EDME	2	2	4	
KAFW	2	2	4	
LSZG	2	2	4	
LSZL	2	2	4	
EGBJ	2	2	4	
MUHA	2	2	4	
EDTD	2	2	4	
LKKB	2	2	4	
LFTH	2	2	4	
LPPD	2	2	4	
LFRS	2	2	4	
TFFF	2	2	4	
EDFQ	2	2	4	
LPBJ	2	2	4	
MUVR	2	2	4	
LFAT	2	2	4	
EHSE	2	2	4	
EHTW	2	2	4	
LFMU	2	2	4	
EGBE	2	2	4	
EGHQ	2	2	4	
EHLE	2	2	4	
EDBA	2	2	4	
EDBJ	2	2	4	
ORSU	2	2	4	
EDQG	2	2	4	
EDAB	2	2	4	
EHTX	2	2	4	
EDQC	2	2	4	
EDPA	2	2	4	
EDLX	2	2	4	
EDFU	1	3	4	
LHTL	0	4	4	
HTZA	0	4	4	
EDLH	0	4	4	
WSSL	0	4	4	
LSZA	3	0	3	
EFTP	3	0	3	
EDBH	3	0	3	
EHTE	3	0	3	
TFFR	2	1	3	
LFAQ	2	1	3	
SKBO	2	1	3	
LFLI	2	1	3	
KTPA	2	1	3	
LFLY	2	1	3	
EDHL	1	2	3	
EGNV	1	2	3	
EDWC	1	2	3	
WIII	1	2	3	
MUHG	1	2	3	
EDMS	0	3	3	
EDTM	0	3	3	
LDZD	0	3	3	
EGPK	0	3	3	
EKSB	2	0	2	
EDLB	2	0	2	
LIPV	2	0	2	
LKKV	2	0	2	
LOWZ	2	0	2	
EDEN	2	0	2	
LFPM	2	0	2	
EGBP	2	0	2	
OBKH	2	0	2	
ETAD	2	0	2	
EDRE	2	0	2	
LFBZ	2	0	2	
EKEB	2	0	2	
LCRA	2	0	2	
DTNH	2	0	2	
LJMB	2	0	2	
EDWG	2	0	2	
EDTH	2	0	2	
LHPR	2	0	2	
ENEV	2	0	2	
LFMD	2	0	2	
EGFE	2	0	2	
EDOY	2	0	2	
LTAG	2	0	2	
EDBM	2	0	2	
EDSZ	1	1	2	
KBED	1	1	2	
EDHF	1	1	2	
LIPY	1	1	2	
EDNR	1	1	2	
UTAA	1	1	2	
EKYT	1	1	2	
EDWE	1	1	2	
EDAC	1	1	2	
EDXG	0	2	2	
ETSI	0	2	2	
LIMG	0	2	2	
KPDX	0	2	2	
ZSJN	0	2	2	
EKKA	0	2	2	
EDFC	0	2	2	
KOPF	0	2	2	
LKMH	0	2	2	
EGNO	0	2	2	
LIPR	0	2	2	
EDWI	0	2	2	
OJAM	0	2	2	
ESKM	0	2	2	
LFMQ	0	2	2	
EDAX	0	2	2	
LEZG	0	2	2	
LPPS	0	2	2	
EFOU	0	2	2	
LFOK	0	2	2	
TNCM	0	2	2	
LIPQ	0	2	2	
LFPZ	0	2	2	
EPRU	0	2	2	
EGJJ	0	2	2	
EIWT	1	0	1	
KBGR	1	0	1	
MBPV	1	0	1	
KSWF	1	0	1	
EIKN	1	0	1	
OPKC	1	0	1	
ESOW	1	0	1	
KLGB	1	0	1	
ESGT	1	0	1	
ENVA	1	0	1	
EDRT	1	0	1	
LEGE	1	0	1	
KSUN	1	0	1	
KWRI	1	0	1	
KPBI	1	0	1	
ETHL	1	0	1	
KTKI	1	0	1	
LLER	1	0	1	
EDXB	1	0	1	
CYKA	1	0	1	
KMSP	1	0	1	
EDWN	1	0	1	
LGIR	1	0	1	
EGUN	1	0	1	
KSKF	1	0	1	
LIBP	1	0	1	
OENN	1	0	1	
ENBO	1	0	1	
EVGA	1	0	1	
MDSD	1	0	1	
KLFI	1	0	1	
KHOP	1	0	1	
EKSP	1	0	1	
ENCN	1	0	1	
VAPO	1	0	1	
LFOZ	1	0	1	
UTAK	0	1	1	
EGTC	0	1	1	
EGCM	0	1	1	
LIMP	0	1	1	
LFLM	0	1	1	
ETNW	0	1	1	
KPSM	0	1	1	
ZBTJ	0	1	1	
EHKD	0	1	1	
RKSS	0	1	1	
VTCT	0	1	1	
EDTF	0	1	1	
ESMT	0	1	1	
LFRZ	0	1	1	
KDAY	0	1	1	
OMFJ	0	1	1	
LSMP	0	1	1	
ETNN	0	1	1	
LRBM	0	1	1	
KGTF	0	1	1	
LFQT	0	1	1	
KFRG	0	1	1	
HSSK	0	1	1	
KCRQ	0	1	1	
RJNA	0	1	1	
VRDA	0	1	1	
ORBI	0	1	1	
UAKK	0	1	1	
EGNH	0	1	1	
LIMZ	0	1	1	
EDPR	0	1	1	
LFGB	0	1	1	
LFLX	0	1	1	
ESTA	0	1	1	
KPIT	0	1	1	
MYNN	0	1	1	
KPTK	0	1	1	
KHPN	0	1	1	
KISP	0	1	1	

22: SELECT f.flightid, valueAtTimeStamp(f.altitude, timestamptz'2023-01-09 09:02:35'), ST_asText(valueAtTimeStamp(f.trip, timestamptz'2023-01-09 09:02:35')) AS location, timestamptz'2023-01-09 09:02:35' FROM citus.flights f WHERE attime(f.trip, timestamptz'2023-01-09 09:02:35') IS NOT NULL;

flightid	valueattimestamp	location	timestamptz	
692816270	471.9	POINT(7.7610833 52.1506951)	2023-01-09 09:02:35+01	
692816350	581.4	POINT(6.8630679 51.332459)	2023-01-09 09:02:35+01	

23: WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM citus.flights f WHERE f.trip && tstzspan'[2023-03-19 19:27:56, 2023-03-29 17:04:06]' GROUP BY f.origin), arrivals AS ( SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM citus.flights f WHERE f.trip && tstzspan'[2023-03-19 19:27:56, 2023-03-29 17:04:06]' GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals, COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count FROM departures d FULL JOIN arrivals a ON d.airport = a.airport ORDER BY traffic_count DESC, departures DESC, arrivals DESC;

airport	departures	arrivals	traffic_count	
EDDL	3247	3240	6487	
EDDK	2574	2411	4985	
EHAM	1924	1716	3640	
EGLL	1327	1586	2913	
EDDF	1397	1216	2613	
EDDM	919	857	1776	
EDDB	734	527	1261	
LOWW	567	521	1088	
EGSS	517	532	1049	
EDLW	531	512	1043	
EBBR	351	690	1041	
EGGW	461	483	944	
LTFM	476	374	850	
EIDW	439	405	844	
EDDG	402	429	831	
EGCC	425	328	753	
EDDH	451	276	727	
LEPA	297	382	679	
LFPG	209	462	671	
LSZH	260	400	660	
EDLP	318	310	628	
LKPR	308	295	603	
LTFJ	307	268	575	
OMDB	323	249	572	
EDLV	277	268	545	
EDDP	248	257	505	
EKCH	301	193	494	
EDDV	277	206	483	
LROP	253	225	478	
EPKK	232	243	475	
EPWA	231	236	467	
LTAI	225	239	464	
EDLN	216	225	441	
EHEH	208	230	438	
EGKK	204	231	435	
LHBP	130	292	422	
OTHH	231	172	403	
EGBB	184	194	378	
LLBG	223	116	339	
EGNX	167	167	334	
LIRF	159	174	333	
LOWS	148	156	304	
LIMC	120	184	304	
EDLE	150	135	285	
EPKT	131	153	284	
LEBL	126	153	279	
HEGN	133	139	272	
LBSF	158	113	271	
EGLC	136	132	268	
EGPH	148	117	265	
KJFK	89	171	260	
LGAV	144	115	259	
EBCI	59	196	255	
LEMD	106	143	249	
GCLP	118	129	247	
ESSA	132	101	233	
GCTS	104	114	218	
LIPZ	108	97	205	
EPWR	100	104	204	
LIME	84	116	200	
EDDW	115	80	195	
LIML	105	89	194	
LPPT	87	101	188	
LSGG	85	102	187	
LOWI	68	119	187	
LEMG	76	104	180	
WSSS	96	82	178	
ENGM	94	84	178	
VIDP	85	93	178	
EDDS	90	83	173	
KORD	81	90	171	
GCFV	77	90	167	
LDZA	91	74	165	
VHHH	80	82	162	
EBLG	91	69	160	
OMAA	94	61	155	
KEWR	54	101	155	
EDDN	77	77	154	
EFHK	101	52	153	
LIPE	89	64	153	
EGGD	74	79	153	
LYBE	75	70	145	
LRCL	68	72	140	
VABB	71	66	137	
CYYZ	67	64	131	
LGTS	69	53	122	
LTBJ	55	63	118	
LEAL	44	74	118	
LFSB	35	77	112	
EPMO	57	54	111	
EHRD	75	35	110	
RKSI	57	52	109	
EGNT	55	54	109	
BKPR	51	57	108	
KIAD	42	66	108	
EPPO	53	54	107	
KSDF	52	54	106	
LCPH	45	59	104	
EVRA	58	43	101	
HECA	62	37	99	
ELLX	55	44	99	
LPFR	47	52	99	
EDKB	53	45	98	
EDDC	49	49	98	
VTBS	43	53	96	
LFMN	48	47	95	
EGGP	56	38	94	
LFLL	39	55	94	
EGNM	52	41	93	
LPPR	43	48	91	
EGKB	42	45	87	
LZIB	47	39	86	
LCLK	44	42	86	
LRIA	43	42	85	
EPRZ	34	51	85	
EPGD	45	39	84	
LATI	55	28	83	
EKBI	41	42	83	
EDMO	40	43	83	
OBBI	46	36	82	
EGPF	40	40	80	
LTAC	39	41	80	
EYVI	45	32	77	
LIRN	37	40	77	
GCRR	36	40	76	
EDVK	35	41	76	
KATL	35	40	75	
ESGG	30	42	72	
EHBK	22	49	71	
OLBA	41	28	69	
EGLF	30	39	69	
BIKF	35	33	68	
KSFO	30	36	66	
LWSK	37	27	64	
EINN	31	33	64	
RJTT	21	43	64	
LBWN	34	29	63	
LPMA	30	32	62	
LEVC	27	35	62	
KDEN	32	29	61	
LIRQ	30	30	60	
OMDW	37	22	59	
OKKK	33	26	59	
EDGS	28	31	59	
EYKA	26	33	59	
ESMS	24	33	57	
HEMA	28	28	56	
KLAX	31	24	55	
EDNY	29	26	55	
LRSV	28	27	55	
CYUL	21	34	55	
OJAI	25	29	54	
KCVG	38	15	53	
LUKK	28	25	53	
HKJK	36	16	52	
WMKK	27	25	52	
KIAH	25	27	52	
EDLI	24	28	52	
KPHL	24	26	50	
LOWG	25	24	49	
LEVT	24	25	49	
LFPO	6	42	48	
LFPB	19	28	47	
KBOS	17	30	47	
KMIA	6	41	47	
LRCV	24	22	46	
LDSP	23	23	46	
VOBL	28	17	45	
EDMA	22	22	44	
EBAW	21	23	44	
LTAU	21	22	43	
LKMT	20	23	43	
KMEM	18	25	43	
LRTR	24	18	42	
EDFE	22	20	42	
LMML	22	20	42	
LJLJ	21	21	42	
LEIB	19	23	42	
EDXW	19	22	41	
LICC	16	25	41	
KDFW	21	19	40	
LRSB	21	19	40	
EDAZ	19	21	40	
LTBS	17	23	40	
EHGG	21	18	39	
EPLB	19	19	38	
EDTY	21	16	37	
EDKA	20	17	37	
EDSB	16	21	37	
LQTZ	18	18	36	
LZKZ	18	18	36	
OERK	18	18	36	
KCLT	14	22	36	
LOWL	18	17	35	
EDVE	19	15	34	
ORER	17	17	34	
KDTW	17	17	34	
LFML	14	20	34	
LFRN	16	17	33	
EDLA	18	14	32	
EBOS	16	16	32	
LFBO	8	23	31	
EHLE	17	13	30	
OEJN	16	14	30	
LEJR	15	15	30	
GMMW	14	16	30	
EDDR	11	19	30	
MMMX	7	23	30	
EDHI	21	8	29	
EDFM	17	12	29	
UBBB	14	15	29	
EDQC	14	15	29	
LSZR	13	16	29	
EDFH	14	14	28	
EDJA	12	16	28	
EGAA	15	12	27	
ZZZZ	15	12	27	
ZGGG	18	8	26	
GMMX	11	15	26	
EDRY	11	15	26	
HESH	9	17	26	
LIPX	9	17	26	
LIRP	14	11	25	
LEBB	12	13	25	
MMUN	8	17	25	
EGWU	12	12	24	
LIBD	11	13	24	
LIMF	7	17	24	
EPBY	17	5	22	
RJAA	16	6	22	
LEGE	8	14	22	
EDWO	13	8	21	
RCTP	11	10	21	
KIND	10	11	21	
LFOB	2	19	21	
OMSJ	12	8	20	
LKTB	12	8	20	
VOHS	11	9	20	
YPPH	10	10	20	
GMAD	10	10	20	
LYNI	10	10	20	
GMFF	10	10	20	
EPLL	9	11	20	
CYVR	8	12	20	
ZSPD	5	15	20	
ZGSZ	3	17	20	
UAAA	13	6	19	
VOMM	12	7	19	
EETN	12	7	19	
VGSY	9	10	19	
LIRA	6	13	19	
ETSI	5	14	19	
EDLD	10	8	18	
LIPB	10	8	18	
DTTA	10	8	18	
LSGS	10	8	18	
LGRP	10	8	18	
KSEA	9	9	18	
OPIS	8	10	18	
LIMJ	8	10	18	
VRMM	8	10	18	
ENZV	6	12	18	
EDFB	11	6	17	
EDWQ	10	7	17	
ZBAA	8	9	17	
KMCO	6	11	17	
OOMS	11	5	16	
LFRS	9	7	16	
LRBC	9	7	16	
EBKT	9	7	16	
LTFH	8	8	16	
ZHCC	8	8	16	
LTCG	8	8	16	
TBPB	8	8	16	
LRTM	7	9	16	
LYPG	7	9	16	
LQSA	9	6	15	
EDTL	9	6	15	
EGHH	8	7	15	
EDDE	7	8	15	
GCLA	7	8	15	
UGTB	7	8	15	
LTAS	7	8	15	
LSZC	7	8	15	
HAAB	14	0	14	
LECH	12	2	14	
LIPO	12	2	14	
LQBK	8	6	14	
VVNB	8	6	14	
LSZB	8	6	14	
LTAF	8	6	14	
LBPD	7	7	14	
LICJ	7	7	14	
EGTK	6	8	14	
LDDU	6	8	14	
LFLB	4	10	14	
ENBR	1	13	14	
UACC	13	0	13	
GMME	7	6	13	
GMTT	6	7	13	
EPSY	6	7	13	
MDPC	2	11	13	
FAOR	0	13	13	
VCBI	11	1	12	
EDVY	9	3	12	
LTFE	8	4	12	
LEZL	6	6	12	
ETNL	6	6	12	
LTAJ	6	6	12	
LIBP	6	6	12	
LEAS	6	6	12	
OPLA	6	6	12	
UGKO	6	6	12	
LWOH	6	6	12	
HRYR	4	8	12	
CYYC	4	8	12	
LFQQ	4	8	12	
LTBA	4	8	12	
LHDC	2	10	12	
LFBD	9	2	11	
LGKR	8	3	11	
GVAC	7	4	11	
EDRZ	5	6	11	
OTBD	5	6	11	
ENTC	4	7	11	
OIIE	4	7	11	
EDTD	4	7	11	
LIEE	4	7	11	
ETND	3	8	11	
PANC	9	1	10	
EDLT	6	4	10	
LSZA	6	4	10	
VAAH	6	4	10	
LSZS	6	4	10	
UATG	5	5	10	
LRCK	5	5	10	
EHTW	5	5	10	
EPSC	5	5	10	
VOGO	5	5	10	
KAUS	5	5	10	
VVTS	5	5	10	
EFRO	5	5	10	
OJAQ	5	5	10	
KTEB	4	6	10	
LOWK	4	6	10	
EICK	4	6	10	
LERS	4	6	10	
EDQM	3	7	10	
GVBA	0	10	10	
CYHM	0	10	10	
EFTU	9	0	9	
HUEN	9	0	9	
UDYZ	8	1	9	
OEDF	8	1	9	
HTDA	7	2	9	
ESSB	7	2	9	
LFMD	6	3	9	
EGNH	6	3	9	
ORSU	5	4	9	
EGHI	5	4	9	
UTTT	5	4	9	
ENTO	5	4	9	
LIPH	4	5	9	
LBBG	3	6	9	
ZSHC	7	1	8	
EDLM	6	2	8	
EDTF	6	2	8	
EHBD	5	3	8	
KBWI	5	3	8	
KSTL	4	4	8	
LDZD	4	4	8	
EGMC	3	5	8	
HTKJ	2	6	8	
AFIL	7	0	7	
EDFZ	6	1	7	
EDRK	5	2	7	
KWRI	5	2	7	
EDMV	4	3	7	
LGSA	3	4	7	
EKRK	3	4	7	
KGSP	3	4	7	
LZTT	3	4	7	
LRBS	3	4	7	
MUVR	3	4	7	
LFLY	2	5	7	
MDLR	2	5	7	
LRSM	2	5	7	
LFMV	2	5	7	
KHPN	2	5	7	
MKJS	2	5	7	
ZHHH	1	6	7	
ETAR	0	7	7	
EDLH	6	0	6	
GOBD	6	0	6	
EGFF	5	1	6	
LIMP	4	2	6	
EDHL	4	2	6	
EDAH	4	2	6	
LESB	4	2	6	
HELX	4	2	6	
VOCI	3	3	6	
UATE	3	3	6	
EGTE	3	3	6	
LGIR	3	3	6	
ETNH	3	3	6	
KLAS	3	3	6	
MUHA	2	4	6	
GCXO	2	4	6	
LFMU	2	4	6	
LFSL	2	4	6	
LFMT	1	5	6	
CYHZ	5	0	5	
EHTE	4	1	5	
KSAN	4	1	5	
EDWI	3	2	5	
EDHF	3	2	5	
ENVA	3	2	5	
EDTM	3	2	5	
LIBR	3	2	5	
EGSC	2	3	5	
MROC	2	3	5	
ETHN	2	3	5	
EGNJ	2	3	5	
WIII	2	3	5	
MPTO	2	3	5	
LOAN	2	3	5	
SKBO	1	4	5	
KTPA	0	5	5	
KHOP	4	0	4	
EGJB	4	0	4	
ESGT	4	0	4	
EDVI	4	0	4	
LGSR	4	0	4	
EGVN	3	1	4	
LCRA	3	1	4	
EDML	2	2	4	
EGAC	2	2	4	
LROD	2	2	4	
EFKT	2	2	4	
DTMB	2	2	4	
LTAN	2	2	4	
LSZG	2	2	4	
EHKD	2	2	4	
EDAQ	2	2	4	
EGNV	2	2	4	
LTCA	2	2	4	
GMFO	2	2	4	
LFMP	2	2	4	
LDPL	2	2	4	
LEZG	2	2	4	
LFLI	2	2	4	
LICT	2	2	4	
EDWU	2	2	4	
LFAV	2	2	4	
ESNQ	2	2	4	
LTCC	2	2	4	
VTSP	2	2	4	
EDFC	1	3	4	
EDPA	1	3	4	
EPZG	0	4	4	
EPLS	0	4	4	
LFTZ	0	4	4	
FACT	0	4	4	
MDPP	0	4	4	
EGBJ	3	0	3	
MMGL	3	0	3	
LTBY	3	0	3	
EKAH	3	0	3	
LKKV	3	0	3	
LKMH	2	1	3	
EDQG	2	1	3	
EGPK	2	1	3	
OMAD	2	1	3	
KBGR	2	1	3	
LFLX	2	1	3	
EGNE	1	2	3	
EKYT	1	2	3	
KRSW	1	2	3	
EDCJ	1	2	3	
EDWF	1	2	3	
EDWE	1	2	3	
EDWC	1	2	3	
EDBN	1	2	3	
LDRI	1	2	3	
EKSB	1	2	3	
CYYT	1	2	3	
MUHG	0	3	3	
ESGJ	0	3	3	
LIRZ	0	3	3	
EGTF	0	3	3	
LIPK	0	3	3	
LFDN	0	3	3	
EDLS	0	3	3	
EHWO	0	3	3	
ESMQ	0	3	3	
HTZA	0	3	3	
KMLI	2	0	2	
LFCW	2	0	2	
LSGK	2	0	2	
LPCS	2	0	2	
EDQD	2	0	2	
KDOV	2	0	2	
KSTP	2	0	2	
EDNR	2	0	2	
EDBO	2	0	2	
KRST	2	0	2	
MYNN	2	0	2	
HKMO	2	0	2	
LERL	2	0	2	
LSZM	2	0	2	
EDHK	2	0	2	
EFPO	2	0	2	
ENDU	2	0	2	
EDEW	2	0	2	
LZSL	2	0	2	
EDBR	2	0	2	
KUGN	2	0	2	
ETHF	2	0	2	
EDMS	2	0	2	
EDXF	2	0	2	
LIDT	2	0	2	
EKEB	2	0	2	
TNCM	2	0	2	
LFAQ	1	1	2	
KSJC	1	1	2	
LSZL	1	1	2	
UTAA	1	1	2	
EDBM	1	1	2	
LIPQ	1	1	2	
ETAD	1	1	2	
LFLP	1	1	2	
EGSH	1	1	2	
LPPD	1	1	2	
EIKY	1	1	2	
LGZA	1	1	2	
KRFD	1	1	2	
EDFQ	1	1	2	
EGPN	1	1	2	
EGPC	1	1	2	
EGTC	1	1	2	
EDAC	1	1	2	
BIRK	1	1	2	
CYQX	0	2	2	
ENHA	0	2	2	
EGNO	0	2	2	
DXXX	0	2	2	
WSSL	0	2	2	
LEVD	0	2	2	
EDGM	0	2	2	
DNMM	0	2	2	
LHTL	0	2	2	
EKSP	0	2	2	
ESKN	0	2	2	
DTTJ	0	2	2	
ETNN	0	2	2	
EGPE	0	2	2	
EDAX	0	2	2	
EDFW	0	2	2	
EGMD	0	2	2	
EGBT	0	2	2	
LZPP	0	2	2	
EDTH	0	2	2	
EDAY	0	2	2	
LIMG	0	2	2	
KNZY	0	2	2	
ETHC	0	2	2	
LIQS	0	2	2	
LERJ	0	2	2	
EGSY	0	2	2	
LFLD	0	2	2	
EDMX	0	2	2	
EPPW	0	2	2	
LOAG	0	2	2	
EDNL	0	2	2	
LIEO	0	2	2	
EDFL	0	2	2	
EDXR	0	2	2	
EDWK	1	0	1	
LGIO	1	0	1	
LFKF	1	0	1	
KVAD	1	0	1	
EGLD	1	0	1	
KGTB	1	0	1	
EGNR	1	0	1	
EKKA	1	0	1	
LLER	1	0	1	
KFAR	1	0	1	
RJBB	1	0	1	
UAOO	1	0	1	
EGUN	1	0	1	
LKPM	1	0	1	
MMSD	1	0	1	
KADW	1	0	1	
LIMZ	1	0	1	
KAFW	1	0	1	
OENN	1	0	1	
SAEZ	1	0	1	
ESOK	1	0	1	
ESOE	1	0	1	
RKSS	1	0	1	
LGKO	1	0	1	
OMRK	1	0	1	
LFOV	1	0	1	
KRIV	1	0	1	
EDXM	1	0	1	
EKOD	1	0	1	
KFLL	1	0	1	
LGKL	1	0	1	
ENML	1	0	1	
TAPA	1	0	1	
KTIK	1	0	1	
EDGE	1	0	1	
EDKV	1	0	1	
ESNO	1	0	1	
LFRT	1	0	1	
ESPA	1	0	1	
EGHQ	1	0	1	
LYTV	1	0	1	
LFPT	0	1	1	
KBED	0	1	1	
EDAK	0	1	1	
HSSK	0	1	1	
LFLS	0	1	1	
EDBH	0	1	1	
EDAB	0	1	1	
TFFR	0	1	1	
LFTH	0	1	1	
LEPP	0	1	1	
KSAV	0	1	1	
TFFF	0	1	1	
LIDE	0	1	1	
ESSL	0	1	1	
KCHA	0	1	1	
KBFI	0	1	1	
ZSJN	0	1	1	
EDTQ	0	1	1	
EYPA	0	1	1	
ZUUU	0	1	1	
LFPL	0	1	1	
KPHX	0	1	1	
EDMJ	0	1	1	
KMHT	0	1	1	
EGJJ	0	1	1	
EBMB	0	1	1	
DAAG	0	1	1	
MGGT	0	1	1	
DGAA	0	1	1	
TGPY	0	1	1	
LSZF	0	1	1	
VRDA	0	1	1	
EDRT	0	1	1	
EGBP	0	1	1	
KLEX	0	1	1	
LFRG	0	1	1	
KOPF	0	1	1	
EDCG	0	1	1	
EDHE	0	1	1	
LIEA	0	1	1	
OBKH	0	1	1	
EDFY	0	1	1	
OEAO	0	1	1	
UTDD	0	1	1	
DTTX	0	1	1	

24: SELECT b.name, COUNT (*) FROM citus.flights f, districts b WHERE f.trip && stbox(b.geom, timestamptz'2023-07-07 00:00:44') AND eintersects(attime(f.trip, timestamptz'2023-07-07 00:00:44'), b.geom) GROUP BY b.name;

name	count	
Rbz Arnsberg	1	
Rbz Koeln	7	
Rbz Detmold	4	
Rbz Muenster	2	
Rbz Duesseldorf	3	

25: SELECT g.name, f.flightid, f.origin, f.destination, f.airplanetype, duration(whenTrue(attime(f.altitude, tstzspan'[2023-10-06 16:02:04, 2023-10-15 09:05:36]') #< 1850 & tintersects(tgeompoint(attime(f.trip, tstzspan'[2023-10-06 16:02:04, 2023-10-15 09:05:36]')), geometry(g.geom)))) AS totalTimeBelowAltitude FROM municipalities g JOIN citus.flights f ON f.trip && stbox(g.geom, tstzspan'[2023-10-06 16:02:04, 2023-10-15 09:05:36]') AND eintersects(attime(f.trip, tstzspan'[2023-10-06 16:02:04, 2023-10-15 09:05:36]'), g.geom) WHERE g.name = 'Gem Lippetal' AND duration(whenTrue(attime(f.altitude, tstzspan'[2023-10-06 16:02:04, 2023-10-15 09:05:36]') #< 1850 & tintersects(tgeompoint(attime(f.trip, tstzspan'[2023-10-06 16:02:04, 2023-10-15 09:05:36]')), geometry(g.geom)))) IS NOT NULL;

name	flightid	origin	destination	airplanetype	totaltimebelowaltitude	
Gem Lippetal	758221761	EDDG	EDLE	PA44	00:05:20	
Gem Lippetal	758860491	EPKT	EDLW	B738	00:00:41	
Gem Lippetal	759010111	EDLE	EDLP	C172	00:02:36	
Gem Lippetal	758936221	EPGD	EDLW	A320	00:00:33	
Gem Lippetal	759262241	LFQG	EDLI	M20P	00:02:10	
Gem Lippetal	759186881	EYVI	EDLW	A320	00:01:51	
Gem Lippetal	758070001	EYVI	EDLW	A320	00:00:51	
Gem Lippetal	756742331	EPKT	EDLW	B738	00:00:53	
Gem Lippetal	758282121	EPKT	EDLW	B738	00:00:52	
Gem Lippetal	758151351	EPSY	EDLW	A320	00:01:04	
Gem Lippetal	758167511	EPKT	EDLW	B738	00:00:56	
Gem Lippetal	756737411	EDDB	EDLW	D328	00:00:06	
Gem Lippetal	758501031	EPKT	EDLW	B738	00:00:56	
Gem Lippetal	759182741	EPGD	EDLW	A320	00:00:57	
Gem Lippetal	756648671	EPGD	EDLW	A320	00:00:47	
Gem Lippetal	759256941	EPSY	EDLW	A320	00:01:39	
Gem Lippetal	757634981	EDHL	EDKA	BE33	00:01:11	
Gem Lippetal	758924641	EPKT	EDLW	B738	00:00:49	
Gem Lippetal	756525661	EDXW	EDLW	C25A	00:00:39	
Gem Lippetal	757662481	EDLW	EDLE	C172	00:02:39	
Gem Lippetal	756642341	EYVI	EDLW	A320	00:00:58	
Gem Lippetal	757662481	EDLW	EDLE	C172	00:06:03	
Gem Lippetal	759224651	EPGD	EDLW	A320	00:01:47	
Gem Lippetal	756718231	EPGD	EDLW	A320	00:01:12	
Gem Lippetal	758666291	EPGD	EDLW	A320	00:00:47	
Gem Lippetal	756509371	BKPR	EDLW	A320	00:01:20	
Gem Lippetal	757250751	LOWG	EDLW	CL35	00:00:21	
Gem Lippetal	758176841	ETMN	EDLW	E550	00:00:05	
Gem Lippetal	759391371	EPKT	EDLW	A320	00:01:08	
Gem Lippetal	758518161	UDYZ	EDLW	A21N	00:00:32	
Gem Lippetal	759249891	EPKT	EDLW	B738	00:00:47	
Gem Lippetal	759251441	EDLW	EDLE	PA44	00:04:44	
Gem Lippetal	759251441	EDLW	EDLE	PA44	00:03:18	
Gem Lippetal	758139121	EPGD	EDLW	A320	00:01:28	
Gem Lippetal	758229141	EFHK	EDLW	C25B	00:00:33	
Gem Lippetal	758837911	EPKT	EDLW	A320	00:01:29	
Gem Lippetal	759169281	EPKT	EDLW	A21N	00:01:22	
Gem Lippetal	756753921	EPSY	EDLW	A320	00:02:00	
Gem Lippetal	758660081	EYVI	EDLW	A320	00:01:02	
Gem Lippetal	756551271	EDLE	EDLP	C172	00:05:58	
Gem Lippetal	757553491	EDLP	EDLE	DA42	00:02:44	
Gem Lippetal	757553491	EDLP	EDLE	DA42	00:00:20	
Gem Lippetal	758177371	EDTD	EDLW	PC12	00:02:02	
Gem Lippetal	758936191	EDDK	EDLN	PA44	00:00:04	
Gem Lippetal	758936191	EDDK	EDLN	PA44	00:01:13	
Gem Lippetal	756874051	EDHK	EDLW	D328	00:00:25	
Gem Lippetal	757263451	EPGD	EDLW	A320	00:00:28	
Gem Lippetal	758564161	EPKT	EDLW	A320	00:01:34	

26: SELECT f.flightid, valueAtTimeStamp(f.altitude, timestamptz'2023-03-12 09:09:31'), ST_asText(valueAtTimeStamp(f.trip, timestamptz'2023-03-12 09:09:31')) AS location, timestamptz'2023-03-12 09:09:31' FROM citus.flights f WHERE attime(f.trip, timestamptz'2023-03-12 09:09:31') IS NOT NULL;

flightid	valueattimestamp	location	timestamptz	
702621461	2305.5	POINT(6.3424978 51.1074464)	2023-03-12 09:09:31+01	
702624201	8976.7	POINT(7.2819051 51.1286364)	2023-03-12 09:09:31+01	
702624271	12497	POINT(7.5189814 50.8815094)	2023-03-12 09:09:31+01	
702622111	3836.3	POINT(6.0277533 51.8203748)	2023-03-12 09:09:31+01	
702620150	441.7	POINT(6.8535758 51.3280279)	2023-03-12 09:09:31+01	
702622851	9760.9	POINT(6.5047829 51.5301414)	2023-03-12 09:09:31+01	
702624581	11582.4	POINT(8.9039712 52.2550379)	2023-03-12 09:09:31+01	
702624601	10058.4	POINT(8.6254067 51.9752222)	2023-03-12 09:09:31+01	
702625071	11210.7	POINT(7.5686825 51.9142594)	2023-03-12 09:09:31+01	
702625631	10671.6	POINT(7.656515 51.0055822)	2023-03-12 09:09:31+01	
702623701	4626.3	POINT(6.222898 51.1253881)	2023-03-12 09:09:31+01	
702624791	11277.6	POINT(6.4114749 51.4686869)	2023-03-12 09:09:31+01	
702622161	10972.9	POINT(6.5311389 50.6476915)	2023-03-12 09:09:31+01	
702625780	875.9	POINT(7.533416 51.49024)	2023-03-12 09:09:31+01	
702622861	11577	POINT(6.7458373 51.2703752)	2023-03-12 09:09:31+01	
702623871	11592.1	POINT(6.7401079 50.6266458)	2023-03-12 09:09:31+01	
702625051	10668	POINT(7.6408264 52.3967307)	2023-03-12 09:09:31+01	
702621841	4790.5	POINT(7.8442584 51.8106232)	2023-03-12 09:09:31+01	
702622721	8229.3	POINT(8.8614266 51.9978299)	2023-03-12 09:09:31+01	

27: SELECT f.flightid, valueAtTimeStamp(f.altitude, timestamptz'2023-04-21 04:43:41'), ST_asText(valueAtTimeStamp(f.trip, timestamptz'2023-04-21 04:43:41')) AS location, timestamptz'2023-04-21 04:43:41' FROM citus.flights f WHERE attime(f.trip, timestamptz'2023-04-21 04:43:41') IS NOT NULL;

flightid	valueattimestamp	location	timestamptz	
710899811	3050.1	POINT(7.4805967 50.789654)	2023-04-21 04:43:41+02	
710899691	10059.2	POINT(8.0866761 51.8491898)	2023-04-21 04:43:41+02	
710900341	5268.8	POINT(7.9554319 51.2271402)	2023-04-21 04:43:41+02	
710899581	4280	POINT(6.8971019 50.7393589)	2023-04-21 04:43:41+02	
710900211	1551.9	POINT(7.2566562 50.8126097)	2023-04-21 04:43:41+02	
710898921	2276.6	POINT(6.6565653 50.9340429)	2023-04-21 04:43:41+02	
710899031	3347.8	POINT(9.082253 51.9622802)	2023-04-21 04:43:41+02	
710900621	3933.2	POINT(7.690317 50.9004056)	2023-04-21 04:43:41+02	
710899221	8043.8	POINT(7.3964957 51.1758898)	2023-04-21 04:43:41+02	
710900150	819.8	POINT(7.1723129 50.8501223)	2023-04-21 04:43:41+02	
710900771	1836.5	POINT(7.3288877 50.9232813)	2023-04-21 04:43:41+02	
710899391	10972.9	POINT(8.7718796 51.6926215)	2023-04-21 04:43:41+02	

28: SELECT g.name, f.flightid, f.origin, f.destination, f.airplanetype, duration(whenTrue(attime(f.altitude, tstzspan'[2023-05-28 19:09:14, 2023-06-01 13:00:38]') #< 1750 & tintersects(tgeompoint(attime(f.trip, tstzspan'[2023-05-28 19:09:14, 2023-06-01 13:00:38]')), geometry(g.geom)))) AS totalTimeBelowAltitude FROM municipalities g JOIN citus.flights f ON f.trip && stbox(g.geom, tstzspan'[2023-05-28 19:09:14, 2023-06-01 13:00:38]') AND eintersects(attime(f.trip, tstzspan'[2023-05-28 19:09:14, 2023-06-01 13:00:38]'), g.geom) WHERE g.name = 'Gem Kirchlengern' AND duration(whenTrue(attime(f.altitude, tstzspan'[2023-05-28 19:09:14, 2023-06-01 13:00:38]') #< 1750 & tintersects(tgeompoint(attime(f.trip, tstzspan'[2023-05-28 19:09:14, 2023-06-01 13:00:38]')), geometry(g.geom)))) IS NOT NULL;

name	flightid	origin	destination	airplanetype	totaltimebelowaltitude	

29: WITH hourly_flights AS ( SELECT generate_series( DATE '2023-07-27'::timestamp, DATE '2023-07-27' + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ), filtered_flights AS ( SELECT f.flightid, g.name AS municipality_name, g.geom as polygon,  attime(f.trip, span('2023-07-27'::timestamp, '2023-07-27'::timestamp + INTERVAL '1 day')) AS daily_trip FROM citus.flights f JOIN municipalities g ON eintersects(f.trip, g.geom) WHERE f.trip && span('2023-07-27'::timestamp, '2023-07-27'::timestamp + INTERVAL '1 day') AND g.name = 'Gem Hennef (Sieg)' ) SELECT h.start_time, COUNT(f.flightid) AS active_flights FROM hourly_flights h LEFT JOIN filtered_flights f ON eintersects(attime(f.daily_trip, span(h.start_time, h.start_time + INTERVAL '1 hour')), polygon) WHERE f.municipality_name = 'Gem Hennef (Sieg)' GROUP BY h.start_time ORDER BY h.start_time;

start_time	active_flights	
2023-07-27 00:00:00	17	
2023-07-27 01:00:00	22	
2023-07-27 02:00:00	30	
2023-07-27 03:00:00	10	
2023-07-27 04:00:00	12	
2023-07-27 05:00:00	10	
2023-07-27 06:00:00	15	
2023-07-27 07:00:00	6	
2023-07-27 08:00:00	10	
2023-07-27 09:00:00	14	
2023-07-27 10:00:00	11	
2023-07-27 11:00:00	10	
2023-07-27 12:00:00	14	
2023-07-27 13:00:00	9	
2023-07-27 14:00:00	18	
2023-07-27 15:00:00	16	
2023-07-27 16:00:00	22	
2023-07-27 17:00:00	23	
2023-07-27 18:00:00	17	
2023-07-27 19:00:00	16	
2023-07-27 20:00:00	39	
2023-07-27 21:00:00	33	
2023-07-27 22:00:00	54	
2023-07-27 23:00:00	41	

30: WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), airport_city_mapping AS ( SELECT a.icao, COALESCE(c.name, 'abroad') AS city_name FROM airports a LEFT JOIN cities c ON a.city = c.name ) SELECT f.flightid, f.origin AS origin_airport, acm1.city_name AS origin_city, f.destination AS destination_airport, acm2.city_name AS destination_city FROM citus.flights f JOIN counties k ON k.name = 'Krs Duisburg' LEFT JOIN airport_city_mapping acm1 ON f.origin = acm1.icao LEFT JOIN airport_city_mapping acm2 ON f.destination = acm2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports)) AND f.trip && stbox(k.geom, tstzspan'[2023-03-15 06:56:37, 2023-03-16 10:46:57]') AND eintersects(attime(f.trip, tstzspan'[2023-03-15 06:56:37, 2023-03-16 10:46:57]'), k.geom) ORDER BY origin_airport, destination_airport, f.flightid;

flightid	origin_airport	origin_city	destination_airport	destination_city	
703075401	EDDK	Cologne	EGNJ	abroad	
703045331	EDDK	Cologne	EHAM	abroad	
703052831	EDDL	Duesseldorf	EDBM	abroad	
703037111	EDDL	Duesseldorf	EDDB	abroad	
703111721	EDDL	Duesseldorf	EDDB	abroad	
703125101	EDDL	Duesseldorf	EDDB	abroad	
703165801	EDDL	Duesseldorf	EDDB	abroad	
703181921	EDDL	Duesseldorf	EDDB	abroad	
704910011	EDDL	Duesseldorf	EDDB	abroad	
704916261	EDDL	Duesseldorf	EDDB	abroad	
703035501	EDDL	Duesseldorf	EDDC	abroad	
703172521	EDDL	Duesseldorf	EDDC	abroad	
704894491	EDDL	Duesseldorf	EDDC	abroad	
703034101	EDDL	Duesseldorf	EDDH	abroad	
703171821	EDDL	Duesseldorf	EDDH	abroad	
704892941	EDDL	Duesseldorf	EDDH	abroad	
703089721	EDDL	Duesseldorf	EDDL	Duesseldorf	
703101251	EDDL	Duesseldorf	EFHK	abroad	
703173301	EDDL	Duesseldorf	EFHK	abroad	
703049521	EDDL	Duesseldorf	EFRO	abroad	
703082811	EDDL	Duesseldorf	EHAM	abroad	
703123691	EDDL	Duesseldorf	EHAM	abroad	
703167691	EDDL	Duesseldorf	EHAM	abroad	
704889481	EDDL	Duesseldorf	EHAM	abroad	
703068731	EDDL	Duesseldorf	EIDW	abroad	
703088321	EDDL	Duesseldorf	EIDW	abroad	
703184531	EDDL	Duesseldorf	EIDW	abroad	
703068541	EDDL	Duesseldorf	EKCH	abroad	
703148571	EDDL	Duesseldorf	EKCH	abroad	
703169601	EDDL	Duesseldorf	EKCH	abroad	
703172991	EDDL	Duesseldorf	EKCH	abroad	
704889741	EDDL	Duesseldorf	EKCH	abroad	
704894281	EDDL	Duesseldorf	EKCH	abroad	
704939081	EDDL	Duesseldorf	EKCH	abroad	
703080541	EDDL	Duesseldorf	ENGM	abroad	
703173311	EDDL	Duesseldorf	ENGM	abroad	
703099741	EDDL	Duesseldorf	EPWA	abroad	
703179301	EDDL	Duesseldorf	EPWA	abroad	
703182811	EDDL	Duesseldorf	EPWA	abroad	
704898141	EDDL	Duesseldorf	EPWA	abroad	
704934981	EDDL	Duesseldorf	EPWA	abroad	
703094581	EDDL	Duesseldorf	EPWR	abroad	
703111961	EDDL	Duesseldorf	ESGG	abroad	
703081871	EDDL	Duesseldorf	ESSA	abroad	
703154981	EDDL	Duesseldorf	ESSA	abroad	
703158211	EDDL	Duesseldorf	ESSA	abroad	
703179721	EDDL	Duesseldorf	ESSA	abroad	
704894731	EDDL	Duesseldorf	ESSA	abroad	
703062351	EDDL	Duesseldorf	EVRA	abroad	
703177981	EDDL	Duesseldorf	EVRA	abroad	
703170131	EDDL	Duesseldorf	LKPR	abroad	
704899921	EDDL	Duesseldorf	LKPR	abroad	
704899401	EDDL	Duesseldorf	LTFJ	abroad	
703185591	EDDL	Duesseldorf	OMDB	abroad	
704921561	EDLN	Moenchengladbach	EDDG	Muenster	
703148331	EDLN	Moenchengladbach	EDLM	NULL	
703065801	EDLN	Moenchengladbach	EDLN	Moenchengladbach	
703091181	EDLN	Moenchengladbach	EDWE	abroad	
703129701	EDLW	Dortmund	EDLW	Dortmund	
703053641	EGBB	abroad	EDDL	Duesseldorf	
704917551	EGBB	abroad	EDDL	Duesseldorf	
704914191	EGCC	abroad	EDDL	Duesseldorf	
703088951	EGLC	abroad	EDDL	Duesseldorf	
704906041	EGLC	abroad	EDDL	Duesseldorf	
703043191	EGLL	abroad	EDDL	Duesseldorf	
703103541	EGLL	abroad	EDDL	Duesseldorf	

31: SELECT f.flightid, f.track FROM citus.flights f, counties k WHERE k.name = 'Krs Gelsenkirchen' AND f.trip && stbox(k.geom, tstzspan'[2023-05-18 14:44:44, 2023-05-20 06:12:05]') AND eintersects(attime(f.trip, tstzspan'[2023-05-18 14:44:44, 2023-05-20 06:12:05]'), k.geom);

flightid	track	
717648751	1	
717667521	1	
717888051	1	
717896611	2	
717552471	1	
717573291	1	
717785420	5	
717792051	1	
717958311	1	
717975531	1	
717652711	1	
717662381	1	
717689111	1	
717738601	2	
717939771	1	
717949001	2	
717681771	2	
717733981	2	
717809150	1	
717809150	2	
717811691	1	
717908951	1	
717570211	1	
717752071	1	
717780021	1	
717891071	2	
717946821	1	
717568011	1	
717603381	1	
717664761	1	
717706271	1	
717873901	2	
717968781	1	
717610590	3	
717626661	1	
717626921	1	
717660381	1	
717689561	1	
717966141	1	
717608411	3	
717656871	1	
717821351	2	
717874921	2	
717894581	3	
717625680	7	
717653381	1	
717669241	1	
717684391	1	
717783751	1	
717669221	2	
717856060	1	
717883291	1	
717916061	2	
717926681	2	
717553041	1	
717577131	3	
717591941	1	
717681181	2	
717811251	1	
717613031	1	
717702681	2	
717791651	1	
717886381	2	
717551421	1	
717601681	1	
717901201	1	
717663681	1	
717717861	2	
717969591	1	
717878001	1	
717610591	2	
717660741	1	
717843941	2	
717917601	2	
717567981	2	
717618561	2	
717663951	1	
717823861	1	
717956371	1	
717686911	1	
717742711	1	
717874851	1	
717949541	1	
717973551	1	
717728141	1	
717732981	1	
717869661	1	
717798261	1	
717569561	1	
717595401	1	
717596321	1	
717709271	2	
717715151	1	
717731611	1	
717777941	1	
717625681	3	
717750351	2	
717792321	1	
717904631	2	
717934231	2	
717785421	1	
717639861	1	
717749981	1	
717842481	1	
717894580	4	
717964471	2	
717659961	1	
717699361	1	
717820511	1	
717964481	1	
717965641	1	
717564551	1	
717647431	1	
717648431	1	
717702071	1	
717809151	1	
717839841	2	
717646321	1	
717662851	1	
717668011	3	
717944011	2	
717959251	1	
717565080	4	
717565081	4	
717582800	8	
717632801	1	
717765741	2	
717770791	1	
717828891	1	
717950561	1	
717778541	1	
717897401	1	
717909751	1	
717924971	1	
717924971	3	
717965301	1	
717973251	1	
717634421	1	
717688691	1	
717923281	1	
717547041	2	
717588371	1	
717645261	1	
717820551	3	
717837931	1	
717863521	1	
717966641	1	
717573281	2	
717619701	2	
717834681	1	
717856531	1	
717750761	1	
717814820	1	
717842441	1	
717944071	1	
717976831	2	
717630521	2	
717708191	1	
717709261	1	
717851441	1	
717939411	2	
717616251	3	
717872951	1	
717861311	1	
717921051	2	
717926301	1	
717974311	1	

32: SELECT p.flightid, p.altitude, p.airplanetype, p.timestamp FROM flightpoints p JOIN cities c ON ST_DWithin(p.geom, c.geom, 60)   WHERE p.altitude <= 1200 AND c.population >= 200000;

flightid	altitude	airplanetype	timestamp	
730978851	1005.3	A319	2023-07-07 14:09:51	
701683590	513.1	DA40	2023-03-06 11:29:02	
711662381	1025.9	A319	2023-04-24 09:01:29	
709711921	1086	A321	2023-04-14 16:43:55	
733899670	284.5	EVOT	2023-07-18 15:52:32	
700070081	1125.4	PA44	2023-02-26 16:44:19	
706424060	548	PA44	2023-03-29 12:08:19	
700621811	1150.1	B38M	2023-03-01 17:56:38	
743387911	1183.2	DA42	2023-08-23 12:50:57	
691893930	244.1	EC35	2023-01-02 20:42:01	
730568691	1168.1	PA44	2023-07-06 09:06:59	
715282021	1009.2	A319	2023-05-08 13:53:53	
692627920	776.5	P28A	2023-01-07 16:13:18	
695088531	1010.7	C172	2023-01-24 15:41:41	
726670431	951	C172	2023-06-20 13:56:18	
698296121	970.4	P28A	2023-02-15 12:10:25	
692763130	648.6	PA44	2023-01-08 17:04:19	
718904360	382.3	M20P	2023-05-23 14:58:14	
763048000	697.3	PA44	2023-10-30 16:25:59	
730129950	662.4	C172	2023-07-04 08:41:47	
708854401	1135.9	A320	2023-04-10 12:21:22	
740027491	940.1	PA44	2023-08-11 09:06:49	
735340931	1034.6	A20N	2023-07-24 10:15:22	
727869010	869	P46T	2023-06-25 08:54:27	
724203721	1134.2	PA44	2023-06-11 12:49:05	
698221110	857.5	E190	2023-02-14 20:46:42	
745934810	871.2	A320	2023-09-03 07:37:40	
726568150	699.6	P46T	2023-06-20 07:17:11	
727596640	308.1	C172	2023-06-24 11:01:03	
714041940	343.5	LJ35	2023-05-03 11:39:28	
728456690	517.7	M20P	2023-06-27 10:53:59	
710135961	1068.4	A320	2023-04-17 07:06:48	
768019420	484.6	BE33	2023-11-25 11:18:33	
733229061	1093.5	E75L	2023-07-16 05:26:17	
694892570	639.3	P28A	2023-01-03 16:56:41	
762093731	1056.2	A320	2023-10-26 08:09:17	
764511711	938.6	A319	2023-11-07 10:23:35	
726855520	465.5	PA44	2023-06-21 11:08:18	
707789400	673.2	TBM8	2023-04-05 13:22:46	
706046481	1158.8	PA44	2023-03-27 11:06:14	
701887751	1187.2	A319	2023-03-07 08:13:17	
757359530	700.7	P28A	2023-09-19 09:27:18	
723398031	916.4	B738	2023-06-08 17:28:06	
771298150	895.5	A20N	2023-12-14 10:37:46	
741323230	870.9	A320	2023-08-15 20:24:22	
697328241	1070.7	P28R	2023-02-09 12:06:57	
722323731	1137.6	A320	2023-06-04 15:22:30	
736573551	963	A332	2023-07-28 18:49:18	
718616141	1149.2	A319	2023-05-22 09:00:05	
700483171	1120.2	CRJ9	2023-03-01 08:49:44	
706569801	1131.3	C172	2023-03-30 08:16:54	
705929730	134.5	A320	2023-03-26 14:06:11	
710086830	360.3	DA40	2023-04-16 18:17:24	
746189581	1098.1	B738	2023-09-03 17:51:11	
715713131	920.4	C172	2023-05-10 17:24:31	
722614970	424.5	SW4	2023-06-05 15:41:20	
693416110	816.4	P46T	2023-01-13 16:41:48	
712821590	640.3	A321	2023-04-30 08:48:09	
749943741	1116.5	A320	2023-09-21 07:41:06	
713484680	622.6	P28A	2023-05-02 16:59:37	
733528530	482.5	PA44	2023-07-17 10:14:12	
740669931	1185.6	TB21	2023-08-13 11:43:25	
700962811	1125.5	C172	2023-03-03 14:33:52	
729670011	945.8	SR20	2023-07-02 11:38:44	

33: WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), airport_city_mapping AS ( SELECT a.icao, COALESCE(c.name, 'abroad') AS city_name FROM airports a LEFT JOIN cities c ON a.city = c.name ) SELECT f.flightid, f.origin AS origin_airport, acm1.city_name AS origin_city, f.destination AS destination_airport, acm2.city_name AS destination_city FROM citus.flights f JOIN counties k ON k.name = 'Krs Rhein-Sieg-Kreis' LEFT JOIN airport_city_mapping acm1 ON f.origin = acm1.icao LEFT JOIN airport_city_mapping acm2 ON f.destination = acm2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports)) AND f.trip && stbox(k.geom, tstzspan'[2023-01-21 20:30:23, 2023-01-22 08:09:51]') AND eintersects(attime(f.trip, tstzspan'[2023-01-21 20:30:23, 2023-01-22 08:09:51]'), k.geom) ORDER BY origin_airport, destination_airport, f.flightid;

flightid	origin_airport	origin_city	destination_airport	destination_city	
694507170	CYHZ	abroad	EDDK	Cologne	
694501581	EDDF	abroad	EDDL	Duesseldorf	
694511510	EDDK	Cologne	EDDM	abroad	
694498121	EDDK	Cologne	LIPZ	abroad	
694502321	EDDL	Duesseldorf	LFLY	abroad	
694496701	EDDL	Duesseldorf	LSZH	abroad	
694502190	EDDM	abroad	EDDK	Cologne	
694502241	EDDM	abroad	EDDL	Duesseldorf	
694503101	EDDM	abroad	EDDL	Duesseldorf	
694503370	EGSS	abroad	EDDK	Cologne	
694503371	EGSS	abroad	EDDK	Cologne	
694497900	EPGD	abroad	EDDK	Cologne	
694497900	EPGD	abroad	EDDK	Cologne	
694497901	EPGD	abroad	EDDK	Cologne	
694497901	EPGD	abroad	EDDK	Cologne	
694493490	GCFV	abroad	EDDK	Cologne	
694506100	GCLP	abroad	EDDK	Cologne	
694506100	GCLP	abroad	EDDK	Cologne	
694506101	GCLP	abroad	EDDK	Cologne	
694506101	GCLP	abroad	EDDK	Cologne	
694507100	GCLP	abroad	EDDK	Cologne	
694493680	HEGN	abroad	EDDK	Cologne	
694507010	KSDF	abroad	EDDK	Cologne	
694507480	KSDF	abroad	EDDK	Cologne	
694509880	LCLK	abroad	EDDK	Cologne	
694509880	LCLK	abroad	EDDK	Cologne	
694499850	LEBL	abroad	EDDK	Cologne	
694499850	LEBL	abroad	EDDK	Cologne	
694499851	LEBL	abroad	EDDK	Cologne	
694499851	LEBL	abroad	EDDK	Cologne	
694497810	LEPA	abroad	EDDK	Cologne	
694497810	LEPA	abroad	EDDK	Cologne	
694513400	LEPA	abroad	EDDK	Cologne	
694513400	LEPA	abroad	EDDK	Cologne	
694501330	LFPG	abroad	EDDK	Cologne	
694501331	LFPG	abroad	EDDK	Cologne	
694501331	LFPG	abroad	EDDK	Cologne	
694495330	LIME	abroad	EDDK	Cologne	
694495331	LIME	abroad	EDDK	Cologne	
694498020	LIME	abroad	EDDK	Cologne	
694498021	LIME	abroad	EDDK	Cologne	
694512730	LOWW	abroad	EDDK	Cologne	
694505530	LTAI	abroad	EDDK	Cologne	
694505530	LTAI	abroad	EDDK	Cologne	
694505531	LTAI	abroad	EDDK	Cologne	
694504460	LTFJ	abroad	EDDK	Cologne	
694504461	LTFJ	abroad	EDDK	Cologne	
694505960	LTFJ	abroad	EDDK	Cologne	
694505961	LTFJ	abroad	EDDK	Cologne	

34: WITH hourly_flights AS ( SELECT generate_series( DATE '2023-02-17'::timestamp, DATE '2023-02-17' + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ), filtered_flights AS ( SELECT f.flightid, g.name AS municipality_name, g.geom as polygon,  attime(f.trip, span('2023-02-17'::timestamp, '2023-02-17'::timestamp + INTERVAL '1 day')) AS daily_trip FROM citus.flights f JOIN municipalities g ON eintersects(f.trip, g.geom) WHERE f.trip && span('2023-02-17'::timestamp, '2023-02-17'::timestamp + INTERVAL '1 day') AND g.name = 'Gem Geilenkirchen' ) SELECT h.start_time, COUNT(f.flightid) AS active_flights FROM hourly_flights h LEFT JOIN filtered_flights f ON eintersects(attime(f.daily_trip, span(h.start_time, h.start_time + INTERVAL '1 hour')), polygon) WHERE f.municipality_name = 'Gem Geilenkirchen' GROUP BY h.start_time ORDER BY h.start_time;

start_time	active_flights	
2023-02-17 00:00:00	1	
2023-02-17 02:00:00	1	
2023-02-17 05:00:00	4	
2023-02-17 06:00:00	2	
2023-02-17 09:00:00	2	
2023-02-17 11:00:00	3	
2023-02-17 13:00:00	1	
2023-02-17 14:00:00	2	
2023-02-17 15:00:00	1	
2023-02-17 16:00:00	1	
2023-02-17 17:00:00	3	
2023-02-17 18:00:00	2	
2023-02-17 19:00:00	1	
2023-02-17 20:00:00	2	
2023-02-17 21:00:00	2	
2023-02-17 22:00:00	2	

35: SELECT COUNT(*), tstzspan'[2023-10-05 08:56:35, 2023-10-10 11:26:36]' FROM citus.flights f WHERE f.trip && tstzspan'[2023-10-05 08:56:35, 2023-10-10 11:26:36]';

count	tstzspan	
30130	[2023-10-05 08:56:35+02, 2023-10-10 11:26:36+02]	

36: SELECT COUNT(*), tstzspan'[2023-11-10 23:09:32, 2023-11-15 21:45:31]' FROM citus.flights f WHERE f.trip && tstzspan'[2023-11-10 23:09:32, 2023-11-15 21:45:31]';

count	tstzspan	
19357	[2023-11-10 23:09:32+01, 2023-11-15 21:45:31+01]	

37: SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.traj, ST_GeogFromText('SRID=4326;POINT(6.508335475259438 51.61901590207067)')) AS min_distance FROM citus.flights f WHERE ST_DWithin(f.traj, ST_GeogFromText('SRID=4326;POINT(6.508335475259438 51.61901590207067)'), 115)   ORDER BY min_distance ASC;

flightid	airplanetype	origin	destination	min_distance	
762433841	B748	EHAM	VHHH	6.15348977	
702982291	SR22	EDDG	EDLD	11.18112911	
714502851	A320	EGBB	EDDL	12.53395827	
706724741	E190	EHAM	LKPR	16.89373067	
696105441	E190	EHAM	LDZA	17.82107181	
715717521	A319	EGLL	EDDL	20.05467367	
696353561	A35K	EHAM	VHHH	20.11824721	
697994231	TB20	EDLV	EDLV	23.54475567	
700544311	E190	EHAM	EDDS	24.66802054	
731359041	A320	LROP	EHEH	28.00994826	
753988441	A321	EGPH	EDDF	28.46622917	
766554101	E295	EHAM	LKPR	28.69692433	
739643071	B78X	KORD	EDDF	28.99716087	
696204701	B738	EHAM	LIBD	29.37932358	
746731161	E190	EHAM	LIRQ	29.62476632	
770837841	A320	EDDL	EGCC	30.7192931	
709211381	A320	EHAM	EDDF	31.14152871	
699375421	A332	EHAM	OKBK	33.17234895	
726684231	E190	EHAM	LSGG	33.1868869	
720076941	B738	ESKN	LEAL	34.12333107	
698024551	B738	EHAM	LGAV	34.34315902	
727646891	B788	LGAV	KORD	34.406578	
754552231	E190	EHAM	EDDN	35.51802779	
704043011	B789	RJAA	EDDF	35.83401062	
756893321	B38M	EHAM	LTBJ	36.10213116	
698894381	A21N	LROP	EHEH	36.17747428	
702479091	P28A	EDLV	EDLN	36.48365061	
748504761	E190	EHAM	EDDN	36.54698384	
770602471	A20N	EGLL	EDDL	36.67212867	
767600801	B77W	KIAD	EDDF	37.45650762	
720365911	B738	LIPZ	EHAM	37.46166408	
762417961	PC12	EDVE	EDLV	37.92017022	
699685061	A359	EHAM	RCTP	37.99759954	
712035621	B772	EHAM	VOBL	38.18483335	
711156901	E75L	EHAM	EDDS	40.71711092	
701288121	A321	LROP	EGGW	40.96184788	
724704740	P28R	EDLN	EDLV	41.14881559	
716398301	A20N	LGIR	EDLV	41.49354794	
702987661	E190	EHAM	EDDN	41.7851371	
702615721	B737	EHAM	LCLK	42.90638694	
724724031	A321	EHAM	LTFJ	44.16821124	
693251261	A332	EHAM	OKBK	44.51700869	
757377701	A320	LRCL	EHEH	44.56983111	
742751001	B748	KSFO	EDDF	44.85171117	
715669121	B733	LICC	EGNM	45.60351569	
746323931	PC12	EHAM	LSZC	46.44369961	
750012931	B739	EHAM	LLBG	46.495876	
737134761	A321	GCFV	EDDH	46.60063815	
696285471	B78X	EHAM	VTBS	46.86008684	
741083141	A319	EHAM	LYBE	47.21725313	
772177311	B744	EHAM	HECA	48.18155231	
721503781	B738	EHAM	LGKF	48.41710333	
721248151	A20N	EHAM	LLBG	48.61599193	
696409891	A20N	EGLL	EDDL	49.21562514	
715735441	A320	EGBB	EDDL	50.38328823	
695453181	B77L	KORD	EDDF	50.59701021	
711965561	B738	EKCH	EDLV	51.02804011	
709512641	E190	EDDL	EHAM	51.17568297	
765218911	A321	EHEH	EPWA	51.54845995	
752291371	B789	RJTT	EDDF	51.87041151	
768445621	A321	EHAM	LTFJ	52.39228304	
737139511	E75L	EHAM	EDDN	52.80809455	
709371751	A319	EHAM	LYBE	53.45769238	
694614271	B789	EHAM	OMAA	54.14883704	
708082861	A320	EGLL	EDDL	54.35960171	
710883881	E190	EHAM	LYBE	54.42612663	
737881211	A320	LBWN	EGGW	54.73398863	
768817391	C56X	ESTA	EDLV	54.7355249	
698365231	B744	EHAM	VTBS	54.91580767	
759722951	E75L	EHAM	LOWG	54.93373009	
747971611	A21N	LHBP	EHEH	55.89117382	
713092671	B738	EHAM	LGIR	56.32054074	
762358981	A21N	LROP	EHEH	57.74377947	
763148081	A319	EGPF	EDDF	59.10913799	
709766341	B738	EHAM	LGKR	59.42277659	
696654851	A21N	LHBP	EHEH	60.93407218	
747866461	B38M	EHAM	LTBJ	60.95785201	
717493431	GL5T	EHAM	LLBG	61.19272451	
694146731	B77L	EHAM	OTHH	61.78241129	
773926401	A21N	LHBP	EHEH	61.84090833	
770468291	E190	EDDL	EHAM	63.01736994	
755090011	B78X	EHAM	VIDP	63.1376329	
697175441	A388	EHAM	OMDB	63.35981634	
764206281	B77W	VABB	EGLL	63.64337049	
747377131	P28R	EDLN	EDLV	64.07595635	
723472041	E75L	EHAM	EDDN	64.32362977	
748643591	B738	EHAM	LKPR	64.37211301	
753466221	C25M	EHEH	EDDB	64.98120157	
748891261	B738	EHAM	LGAV	65.21906552	
752802921	B789	KDEN	EDDF	66.06573725	
738338361	A320	EHEH	EYVI	66.16148624	
693360191	B737	EHAM	EDDN	66.48220587	
706019541	B38M	EGPH	EDLV	66.8674961	
699494091	A333	KSTL	EDDF	67.05731212	
696248641	E190	EGLC	EDDL	67.47885747	
761760801	B738	EHAM	LGRP	67.60830757	
747798491	E295	EHAM	EDDN	68.21894618	
711405251	B772	LLBG	KJFK	69.48455501	
693272101	B738	EHAM	LOWW	69.72409695	
767230181	E295	EHAM	EDDN	70.12191025	
769340661	E190	EHAM	LDZA	70.22611037	
711843360	P28A	EDLE	EDDG	70.30303194	
767320331	B772	EHAM	ZSPD	70.43567678	
770973951	PA44	EDLV	EDLE	70.54457174	
773209301	E190	EHAM	EDDN	70.76406117	
724383191	B738	EDLV	LGSA	71.60887011	
763868971	B738	EHAM	LTAC	71.64964545	
706716381	A359	KDEN	EDDM	71.67052849	
707950651	A319	EHAM	LYBE	72.06539759	
735231661	A319	EHAM	LKPR	72.48867442	
708334141	B738	EHAM	LGAV	72.86185502	
701917271	B38M	BIKF	EDDM	73.09530554	
697208281	A21N	EHAM	LGAV	73.98470586	
723878761	A320	LRCL	EHEH	74.85111048	
765109521	A320	EHAM	LOWW	74.87383741	
727390971	E190	EHAM	EDDF	74.95009149	
719206421	A320	LPPT	EDDH	75.18265684	
758788731	B738	EHAM	LOWS	76.73122149	
708492221	B738	EHAM	EDDM	76.98440086	
766298431	E190	EHAM	LOWG	77.11633463	
709307511	E190	EHAM	EDDN	77.37289497	
755080521	A320	LRCL	EHEH	78.64253736	
713394301	B738	EHAM	LLBG	78.98730332	
746395331	A21N	LHBP	EHEH	79.04209951	
745259711	B738	LGRP	EHEH	79.39508109	
705321141	C172	EDDG	EDLV	79.52900797	
714864121	B38M	EHAM	LGIR	79.56353017	
700101831	B738	EHAM	LOWW	79.63813257	
707150701	E75L	EHAM	EDDN	79.8791554	
692621711	A388	EHAM	OMDB	80.03508471	
695477821	B77W	EHAM	WSSS	80.51144785	
767255611	BCS3	EHAM	LBSF	80.54671313	
696269451	PC12	EHAM	LKTB	80.81322295	
716727191	B738	EHAM	LTAI	80.88343231	
708318041	E190	EHAM	LKPR	81.84083334	
716066101	B738	EHAM	LKPR	82.21499662	
765194801	A320	EHAM	LOWW	82.43466326	
769498291	A321	EHAM	LOWW	82.89908815	
730521041	A321	LYBE	EHEH	82.95392302	
705101551	A320	EHAM	LOWW	83.56581236	
753373491	A21N	LHBP	EHEH	84.26619602	
734682741	PA34	EDHK	EDLV	84.49097653	
696364341	E190	EDDL	EHAM	84.73450545	
719356001	B738	LKPR	EHEH	84.95809168	
697387470	PA44	EDLV	EDLN	85.43665076	
743858071	B788	VIDP	EGLL	86.30385494	
726459051	B738	EHAM	LTAI	86.73378701	
739466831	A319	LOWW	EGLL	87.50919631	
741109731	E75L	EHAM	LKPR	87.5570679	
763217791	E190	EHAM	LDZA	87.81589159	
696052831	E190	EGLC	EDDL	87.88806547	
717702401	B738	EHAM	LGKP	89.7024814	
719418681	B738	EHAM	LGTS	90.56562803	
742781001	A319	EHAM	LYBE	90.90012494	
767628371	A320	LATI	EHEH	91.03510423	
724004761	A359	KSFO	EDDM	91.04630869	
740727870	P28A	EDLE	EDDG	91.39731218	
759841771	A20N	EGLL	EDDL	91.46924203	
710628161	A21N	LWSK	EHEH	91.80632428	
725844491	B38M	EGPH	EDLV	92.05160764	
768838081	B744	EHAM	VABB	92.24619162	
751201241	B748	EHAM	VHHH	92.8078923	
740910491	B788	VIDP	EGLL	93.07657596	
739122581	LJ60	EHAM	EDDN	93.36243776	
739784421	A332	EHAM	OKKK	94.1534365	
700423101	A319	EDDL	EGLL	94.68663296	
700063151	A320	LBSF	EHEH	95.37218067	
720118551	A321	LYBE	EHEH	95.69550175	
762249611	A320	EHAM	EDDM	95.71543132	
735403241	C172	EDLE	EDLV	95.87336238	
691895741	A319	EHAM	LYBE	95.96771803	
699810141	A320	EHAM	HEGN	96.63081728	
757987461	E190	EHAM	EDDN	96.66983217	
738119931	CRJ9	EHAM	EDDM	97.07069619	
728757351	C510	EDDB	EHBD	97.23350426	
706639581	A321	EPWR	EHEH	97.67279002	
717265031	A20N	EHAM	LFSB	99.18464376	
704939691	A21N	EGLL	EDDL	99.29326487	
703145961	A20N	EHAM	LTFJ	99.35729016	
698625381	B739	EHAM	LGAV	99.52070028	
740981351	E190	EDDL	EHAM	100.24265564	
698647871	B744	EHAM	OEJN	100.32349062	
761071961	B738	EHAM	LKPR	100.4102089	
705843821	B738	EHAM	LGAV	100.47971222	
715487841	B78X	EHAM	VIDP	100.92206025	
730742841	B738	EDLV	LDZD	101.25263007	
725711661	B77W	KSFO	EDDF	101.45661308	
709746151	E190	EHAM	EDDN	101.89553516	
753621911	A319	EGLL	EDDL	102.48745675	
714683671	B738	EHAM	LGZA	102.76336722	
706838961	B38M	LMML	EGPH	102.8838928	
722160491	B738	EHAM	LGTS	102.95548705	
738287921	B739	EHAM	LLBG	102.99165554	
695339871	A319	EGBB	EDDL	102.99278883	
722016761	B738	EHAM	LGIR	103.2691263	
763766131	E190	EHAM	LYBE	103.31166277	
755912211	B738	EHAM	LTBS	103.56497023	
759554921	A21N	LTFM	EGKK	103.64632792	
714317101	B78X	EHAM	HKJK	103.94246421	
696135751	C68A	LEMG	ESSB	103.97678003	
715373781	B772	OBBI	EGLL	104.07512406	
693235231	E75L	EHAM	EDDN	104.1945144	
696147961	A20N	EGLL	EDDL	104.91490332	
768877421	GLF6	KTTN	EDLV	105.03726045	
714446751	B738	EGPF	LTBS	105.22632849	
717067190	PA44	EDLN	EDLV	105.27190949	
746408071	B738	EHAM	LGMT	105.32494453	
699517381	E190	EHAM	LYBE	105.44303174	
771477911	A320	EDDL	EIDW	105.66595076	
735083821	B738	EHAM	LTAI	105.72204304	
763512881	E190	EGLC	EDDL	105.84724645	
732962111	E190	EHAM	EDDN	108.03020017	
769980361	A21N	LBWN	EHEH	108.17549818	
760186341	A21N	LHBP	EHEH	108.20439791	
718676231	P28A	EDLE	EDDG	108.3618933	
694166421	B77W	EHAM	HKJK	108.71490256	
737593571	A320	LBWN	EHEH	109.18386768	
698102811	C172	EDLV	EDLE	109.47526611	
697771741	B38M	EGPH	EDLV	109.86271234	
700541611	A319	EHAM	LIML	110.36597124	
771856081	B738	EDLV	LIBD	110.3925023	
709892571	B744	EHAM	VTBS	110.73187735	
697658451	E190	EDDL	EHAM	110.80253161	
694150611	A359	EHAM	WSSS	111.2537737	
763652181	A21N	LHBP	EHEH	111.30625895	
703615051	A21N	EHAM	LTFM	111.38160428	
698279351	A359	EHAM	WSSS	111.53059339	
705901041	A333	EHAM	LTFM	111.54633661	
758910051	E190	EDDL	EHAM	112.54145564	
739851021	B38M	EHEH	EPKK	112.66108419	
704429191	E190	EHAM	EDDF	113.07160854	
717960621	B738	EGPH	EDLV	113.21711859	
722498691	BE60	EDLV	EDLW	113.39400911	
699831831	A20N	LTFJ	EHEH	113.65169611	
733269451	E190	EHAM	LYBE	113.83973447	
724877661	B748	CYYZ	EDDF	113.9453652	
711994311	B748	EDDK	KSDF	113.97127709	
740291001	B763	EDDK	KPHL	113.97734943	
723748321	A320	EKCH	LEMG	114.03330543	
722788631	F2TH	EHAM	EDLV	114.09290329	
702461391	B738	EHAM	LHBP	114.7890797	
715976571	B738	EHAM	LGAV	114.79758913	
748412401	B738	EHAM	LTAI	114.9835934	

thread-1 finished executing at 2025-01-31T21:29:34.326922600Z.
